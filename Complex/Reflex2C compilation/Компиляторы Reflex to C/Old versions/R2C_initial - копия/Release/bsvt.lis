    1                                  Прогр sapun { 
    2          
    3          
    4          /*###########################################################*/
    5          /*#########                     #############################*/
    6          /*#########  ОПИСАНИЕ КОНСТАНТ  #############################*/
    7          /*#########                     #############################*/
    8          /*###########################################################*/
    9          /* ?????????????? Таймауты взяты с потолка */
   10          ТАКТ     50;    /* такт равен 500 миллисекундам */
   11          КОНСТ Т0_1                       0;  /* Константа обеспечивающая паузу в 0.5 сек */
   12          КОНСТ ОДНА_СЕКУНДА               2;  /* Константа обеспечивающая паузу в 1 сек */
   13          КОНСТ ДВЕ_СЕКУНДЫ             2*ОДНА_СЕКУНДА;
   14          КОНСТ ТРИ_СЕКУНДЫ             3*ОДНА_СЕКУНДА;
   15          КОНСТ ПЯТЬ_СЕКУНД             5*ОДНА_СЕКУНДА;
   16          КОНСТ ДЕСЯТЬ_СЕКУНД          10*ОДНА_СЕКУНДА;
   17          КОНСТ ДВАДЦАТЬ_СЕКУНД        20*ОДНА_СЕКУНДА;
   18          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ЗАТ_ВАК			10*ОДНА_СЕКУНДА;
   19          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_САПУНА           	ДЕСЯТЬ_СЕКУНД;
   20          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_УСТР_ПЛАВ_ПУСКА   3*ОДНА_СЕКУНДА;
   21          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ВАК_НАСОСА 		3*ОДНА_СЕКУНДА;
   22          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ВЕНТИЛЯТОРА		ПЯТЬ_СЕКУНД;
   23          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_РЕГ_Т				3*ОДНА_СЕКУНДА;
   24          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_РЕГ_УР			3*ОДНА_СЕКУНДА;
   25          КОНСТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_НАСОС_ОХЛ			3*ОДНА_СЕКУНДА;
   26          КОНСТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ  ДЕСЯТЬ_СЕКУНД;
   27          КОНСТ ОДНА_МИНУТА          60*ОДНА_СЕКУНДА;
   28          КОНСТ ДВЕ_МИНУТЫ          2*ОДНА_МИНУТА;
   29          КОНСТ ПЯТЬ_МИНУТ          5*60*ОДНА_СЕКУНДА;
   30          /* КОНСТ ТАЙМАУТ_ВАКУУМИРОВАНИЯ_ТРУБЫ  30*ОДНА_МИНУТА;*/
   31          КОНСТ ТРИДЦАТЬ_МИНУТ          30*ОДНА_МИНУТА;
   32          КОНСТ ТАЙМАУТ_ЗАДЕРЖКА_НА_ОТКАЧКУ ПЯТЬ_СЕКУНД;
   33          
   34          КОНСТ ВКЛ                1;
   35          КОНСТ ВЫК               0;
   36          КОНСТ ОТКР              1;
   37          КОНСТ ЗАКР          	0;
   38          КОНСТ ЕСТЬ               1;
   39          КОНСТ НЕТ                0;
   40          КОНСТ НОРМА              1;
   41          КОНСТ ВНЕ_НОРМЫ          0;
   42          КОНСТ ДОСТОВЕРНО                1;
   43          КОНСТ НЕДОСТОВЕРНО               0;
   44          
   45          
   46          КОНСТ ТАЙМАУТ_НА_ДИАГНОСТИКУ_РАЗРЫВА_СВЯЗИ 5*ОДНА_СЕКУНДА;
   47          
   48          КОНСТ Т_ПредельнаяВбакеОхлаждения          99.0; 
   49          
   50          /*КОНСТ ЗД_P_ВбакеКомпрессора						10.0; */  /*?????  атмосфер */
   51          
   52          КОНСТ Т_ГИСТЕРЕЗИС_ВОДЫ_В_БАКЕ  1.0;
   53          КОНСТ Т_ГИСТЕРЕЗИС_ВОДЫ_В_РУБАХЕ  1.0;
   54          
   55          
   56          /*===========================================================*/
   57          /*=== КОДЫ СООБЩЕНИЙ ПРОЦЕССОВ КОНТРОЛЯ                     =*/
   58          /*===========================================================*/
   59          ПЕРЕЧИСЛЕНИЕ {
   60              ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_НИЗКИЙ,
   61              ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_ВЫСОКИЙ,
   62          	ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_В_НОРМЕ,
   63          	ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_НИЗКАЯ,
   64          	ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_ВЫСОКАЯ,
   65          	ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_В_НОРМЕ,
   66          
   67              ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_РУБАШКЕ_ОХЛАЖДЕНИЯ_НИЗКАЯ,
   68          	ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_РУБАШКЕ_ОХЛАЖДЕНИЯ_ВЫСОКАЯ,
   69          	ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_РУБАШКЕ_ОХЛАЖДЕНИЯ_В_НОРМЕ,
   70          
   71          	ПК_ГУИ_ДАВЛЕНИЕ_В_ВАКУУМНОЙ_ТРУБЕ_В_НОРМЕ,
   72          	ПК_ГУИ_ДАВЛЕНИЕ_В_ВАКУУМНОЙ_ТРУБЕ_ВНЕ_НОРМЫ,
   73          	
   74          	ПК_ГУИ_СКОРОСТЬ_ОТКАЧКИ_В_НОРМЕ,
   75          	ПК_ГУИ_СКОРОСТЬ_ОТКАЧКИ_НИЖЕ_НОРМЫ,
   76          	
   77          	ПК_ГУИ_ДАВЛЕНИЕ_В_БАКЕ_КОМПРЕССОРА_В_НОРМЕ,
   78              ПК_ГУИ_ДАВЛЕНИЕ_В_БАКЕ_КОМПРЕССОРА_НИЖЕ_НОРМЫ
   79          	
   80          };
   81          /*===========================================================*/
   82          /*========= КОМАНДЫ ОПЕРАТОРА =============15================*/
   83          /*===========================================================*/
   84          ПЕРЕЧИСЛЕНИЕ {
   85               КОМ_ГУИ_ОТКР_ЗАТВОР_ВАК= ПК_ГУИ_ДАВЛЕНИЕ_В_БАКЕ_КОМПРЕССОРА_НИЖЕ_НОРМЫ + 1,
   86               КОМ_ГУИ_ЗАКР_ЗАТВОР_ВАК    	,
   87               КОМ_ГУИ_ОТКР_САПУН			    ,
   88               КОМ_ГУИ_ЗАКР_САПУН			    ,
   89               КОМ_ГУИ_ВКЛ_УСТР_ПЛАВ_ПУСКА    ,
   90               КОМ_ГУИ_ВЫК_УСТР_ПЛАВ_ПУСКА    ,
   91          	 КОМ_ГУИ_ВКЛ_ПИТ_ВАК_НАСОСА     ,
   92          	 КОМ_ГУИ_ВЫК_ПИТ_ВАК_НАСОСА     ,
   93          	 КОМ_ГУИ_ВКЛ_ПИТ_ВЕНТИЛЯТОР    ,
   94          	 КОМ_ГУИ_ВЫК_ПИТ_ВЕНТИЛЯТОР    ,
   95               КОМ_ГУИ_ВКЛ_ПИТ_РЕГ_Т    ,
   96          	 КОМ_ГУИ_ВЫК_ПИТ_РЕГ_Т    ,
   97               КОМ_ГУИ_ВКЛ_ПИТ_РЕГ_УР     ,
   98          	 КОМ_ГУИ_ВЫК_ПИТ_РЕГ_УР     , 
   99          	 КОМ_ГУИ_ВКЛ_ПИТ_НАС_ОХЛ ,
  100          	 КОМ_ГУИ_ВЫК_ПИТ_НАС_ОХЛ    , 
  101          	 КОМ_ГУИ_ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ,
  102          	 КОМ_ГУИ_ВЫК_ВАКУУМИРОВАНИЕ_ТРУБЫ,
  103          	 КОМ_ГУИ_ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ ,
  104          	 КОМ_ГУИ_ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ,   /*  35 */
  105               КОМАНДЫ_ОТ_ГУИ = КОМ_ГУИ_ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ 
  106          	
  107          };
  108          
  109          
  110          /*===========================================================*/
  111          /*========= КОМАНДЫ ИЗМЕНЕНИЯ ФАКТИЧЕСКИХ ПАРАМЕТРОВ ========*/
  112          /*===========================================================*/
  113          
  114          
  115          ПЕРЕЧИСЛЕНИЕ {
  116          	ИЗМН_ФП_P_ВбакеКомпрессора = КОМАНДЫ_ОТ_ГУИ + 1,
  117          	ИЗМН_ФП_P_Впатрубке,
  118          	ИЗМН_ФП_T_Врубашке,	
  119          	ИЗМН_ФП_T_Вбаке,	
  120              ИЗМН_ФП_P_ВтрубеСидер,
  121              КОМАНДЫ_ИЗМ_ФП = ИЗМН_ФП_P_ВтрубеСидер  /*  42 */
  122          };
  123          
  124          /*===========================================================*/
  125          /*===========================================================*/
  126          /*============= КОДЫ СООБЩЕНИЙ ВАКУУМНОЙ СИСТЕМЫ ============*/
  127          /*===========================================================*/
  128          /*===========================================================*/
  129          ПЕРЕЧИСЛЕНИЕ {                    
  130                ПК_ГУИ_ОТКАЗ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО = КОМАНДЫ_ИЗМ_ФП + 1,
  131                ПК_ГУИ_ОТКАЗ_ЗАКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО,
  132                ПК_ГУИ_ОТКАЗ_ОТКРЫТИЯ_САПУНА,
  133                ПК_ГУИ_ОТКАЗ_ЗАКРЫТИЯ_САПУНА,
  134          	  ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_ВЕНТИЛЯТОРА,
  135          	  ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_ВЕНТИЛЯТОРА,
  136          	  ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_УСТР_ПЛАВ_ПУСКА,
  137          	  ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_УСТР_ПЛАВ_ПУСКА,
  138          	  ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ,
  139          	  ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ,
  140          	  ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_РЕГУЛЯТОРА_УРОВНЯ,
  141          	  ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_РЕГУЛЯТОРА_УРОВНЯ,
  142          	  ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_НАСОСА_ОХЛАЖДЕНИЯ,
  143          	  ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_НАСОСА_ОХЛАЖДЕНИЯ,
  144          	  ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ,
  145          	  ПК_ГУИ_НЕТ_УСЛОВИЙ_ДЛЯ_ВЫПОЛНЕНИЯ_КОМАНДЫ,
  146          	  ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_ВНЕ_НОРМЫ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ, 				
  147          	  ПК_ГУИ_ОТРИЦАТЕЛЬНАЯ_ТЕМПЕРАТУРА_ВОДЫ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ,
  148          	  ПК_ГУИ_ДАВЛЕНИЕ_В_ПАТРУБКЕ_НЕ_УМЕНЬШАЕТСЯ,
  149          	  ПК_ГУИ_ДАВЛЕНИЕ_В_ВАК_ТРУБЕ_НЕ_УМЕНЬШАЕТСЯ,
  150          	  ПК_ГУИ_ВАКУУМИРОВАНИЕ_УСПЕШНО_ЗАВЕРШЕНО,	  
  151          	  ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_ПИТАНИЯ_ВАКУУМНОГО_НАСОСА,   /*   */
  152          	  ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_ПИТАНИЯ_ВАКУУМНОГО_НАСОСА,
  153          	  ПК_ГУИ_ВЕНТИЛЯТОР_ВКЛЮЧЕН,
  154          	  ПК_ГУИ_ВЕНТИЛЯТОР_ВЫКЛЮЧЕН,
  155          	  ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_ВЕНТИЛЯТОРА,
  156          	  ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_ВЕНТИЛЯТОРА,
  157          	  ПК_ГУИ_ЗАТВОР_ВАКУУМНЫЙ_ОТКРЫТ,
  158          	  ПК_ГУИ_ЗАТВОР_ВАКУУМНЫЙ_ЗАКРЫТ,
  159          	  ПК_ГУИ_СПОНТАННОЕ_ОТКРЫТИЕ_ЗАТ_ВАКУУМНОГО,
  160          	  ПК_ГУИ_СПОНТАННОЕ_ЗАКРЫТИЕ_ЗАТ_ВАКУУМНОГО,
  161          	  ПК_ГУИ_САПУН_ОТКРЫТ,
  162          	  ПК_ГУИ_САПУН_ЗАКРЫТ,
  163          	  ПК_ГУИ_СПОНТАННОЕ_ОТКРЫТИЕ_САПУНА,
  164          	  ПК_ГУИ_СПОНТАННОЕ_ЗАКРЫТИЕ_САПУНА,
  165          	  ПК_ГУИ_ПИТАНИЕ_ВАКУУМНОГО_НАСОСА_ВКЛЮЧЕНО,
  166          	  ПК_ГУИ_ПИТАНИЕ_ВАКУУМНОГО_НАСОСА_ВЫКЛЮЧЕНО,
  167          	  ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_ВАКУУМНОГО_НАСОСА,
  168          	  ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_ВАКУУМНОГО_НАСОСА,
  169          	  ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ_ВКЛЮЧЕНО,
  170          	  ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ_ВЫКЛЮЧЕНО,
  171            	  ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ,
  172          	  ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ,
  173          	  ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_УРОВНЯ_ВКЛЮЧЕНО,
  174          	  ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_УРОВНЯ_ВЫКЛЮЧЕНО,
  175          	  ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_РЕГУЛЯТОРА_УРОВНЯ,
  176          	  ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_РЕГУЛЯТОРА_УРОВНЯ,
  177          	  ПК_ГУИ_ПИТАНИЕ_НАСОСА_ОХЛАЖДЕНИЯ_ВКЛЮЧЕНО,
  178          	  ПК_ГУИ_ПИТАНИЕ_НАСОСА_ОХЛАЖДЕНИЯ_ВЫКЛЮЧЕНО,
  179          	  ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_НАСОСА_ОХЛАЖДЕНИЯ,
  180          	  ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_НАСОСА_ОХЛАЖДЕНИЯ,
  181          	  ПК_ГУИ_УСТРОЙСТВО_ПЛАВНОГО_ПУСКА_ВКЛЮЧЕНО,
  182          	  ПК_ГУИ_УСТРОЙСТВО_ПЛАВНОГО_ПУСКА_ВЫКЛЮЧЕНО,
  183          	  ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_УСТРОЙСТВА_ПЛАВНОГО_ПУСКА,
  184          	  ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_УСТРОЙСТВА_ПЛАВНОГО_ПУСКА,
  185          	  ПК_ГУИ_ОТКАЗ_ВАКУУМИРОВАНИЯ,
  186          	  ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_ВАКУУМНОЙ_ПОДСИСТЕМЫ,
  187          	  ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_ВАКУУМНОЙ_ПОДСИСТЕМЫ,
  188          	  ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО,
  189                ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО,
  190          	  ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ЗАКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО,
  191          	  ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ЗАКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО,
  192                ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_САПУНА,
  193          	  ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_САПУНА,
  194          	  ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_УСТР_ПЛАВ_ПУСКА,
  195          	  ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_УСТР_ПЛАВ_ПУСКА,
  196          	  ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ПИТ_ВАК_НАСОСА,
  197          	  ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ПИТ_ВАК_НАСОСА,
  198          	  ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ПИТ_ВЕНТИЛЯТОРА,
  199          	  ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ПИТ_ВЕНТИЛЯТОРА
  200          };
  201          
  202          
  203          /*===========================================================*/
  204          /*========= КОДЫ СООБЩЕНИЙ ИЗМЕНЕНИЙ ФП         =============*/
  205          /*===========================================================*/
  206          ПЕРЕЧИСЛЕНИЕ {                    
  207                ПК_ГУИ_ФП_P_ВбакеКомпрессора = ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ПИТ_ВЕНТИЛЯТОРА + 1,
  208                ПК_ГУИ_ФП_P_Впатрубке,
  209                ПК_ГУИ_ФП_T_Врубашке,
  210                ПК_ГУИ_ФП_T_Вбаке,
  211                ПК_ГУИ_ФП_P_ВтрубеСидер
  212                
  213          };
  214          /*===========================================================*/
  215          /*= КОДЫ КОМАНД ИЗМЕНЕНИЯ НАСТРОЕЧНЫХ ПАРАМЕТРОВ   ==========*/
  216          /*===========================================================*/
  217          ПЕРЕЧИСЛЕНИЕ {
  218          ИЗМН_НП_1 = ПК_ГУИ_ФП_P_ВтрубеСидер + 1,
  219          ИЗМН_НП_P_ВбакеКомпрессора = ИЗМН_НП_1,
  220          ИЗМН_НП_Pатмосф,
  221          ИЗМН_НП_ГлубокийВакуумТрубы,
  222          
  223          ИЗМН_НП_N
  224          };
  225          
  226          
  227          
  228          /*===========================================================*/
  229          /*========= КОДЫ СООБЩЕНИЙ  О НЕВЕРНОЙ КОМАНДЕ ==============*/
  230          /*===========================================================*/
  231          
  232          
  233          ПЕРЕЧИСЛЕНИЕ {
  234               ПК_ГУИ_ОШИБКА_КОДА_КОМАНДЫ_ОТ_ГУИ = ИЗМН_НП_N + 1  
  235          }; 
  236          
  237          /*###########################################################*/
  238          /*###########################################################*/
  239          /*########                                          #########*/
  240          /*########  ОПИСАНИЕ ФУНКЦИЙ                        #########*/
  241          /*########                                          #########*/
  242          /*########                                          #########*/
  243          /*###########################################################*/
  244          
  245          /*:::::::::Функции для работы  с ГУИ :::::::::::::::::::::   */
  246          
  247          /*чтение кода и параметра события от ПИВ из кольцевого буфера в память */
  248          ФУНКЦИЯ ЦЕЛ GetNextMsgGUI(ПУСТО);
  249          
  250          ФУНКЦИЯ ЦЕЛ  GetMsgGUICode        (ПУСТО);  /*чтение из памяти кода события */
  251          ФУНКЦИЯ ПЛАВ GetFloatParamGUI     (ПУСТО);  /*чтение из памяти параметра события  используется */
  252          /* ФУНКЦИЯ КЦЕЛ GetShortParamGUI     (ПУСТО); */
  253          ФУНКЦИЯ ЦЕЛ  GetIntParamGUI       (ПУСТО);  /*чтение с экрана гуи - не исползуется */
  254          ФУНКЦИЯ ДЦЕЛ GetLongParamGUI      (ПУСТО);  /*чтение с экрана гуи - исползуется */
  255          
  256          ФУНКЦИЯ ЦЕЛ  SendMsgGUICode       (ЦЕЛ);
  257          ФУНКЦИЯ ЦЕЛ  SendMsgFloatParamGUI (ЦЕЛ, ПЛАВ);
  258          /* ФУНКЦИЯ ЦЕЛ  SendMsgShortParamGUI (ЦЕЛ, КЦЕЛ); */
  259          /* ФУНКЦИЯ ЦЕЛ  SendMsgIntParamGUI   (ЦЕЛ, ЦЕЛ); */
  260          ФУНКЦИЯ ЦЕЛ  SendMsgLongParamGUI  (ЦЕЛ, ДЦЕЛ);
  261          
  262          ФУНКЦИЯ ЦЕЛ  InitChannelStatus_GUI (ПУСТО); /* инициализация статуса,
  263          обнуление числа ошибок */
  264          ФУНКЦИЯ ЦЕЛ  GetChannelStatus_GUI  (ПУСТО);  /* чтение статуса канала 0/1 - не исползуется*/
  265          ФУНКЦИЯ ЦЕЛ  GetErrorNumberCS_GUI  (ПУСТО);  /* чтение числа ошибок КС  - не исползуется*/
  266          ФУНКЦИЯ ЦЕЛ  GetErrorNumberTO_GUI  (ПУСТО);  /* чтение числа ошибок по тайм ауту - не исползуется*/
  267          ФУНКЦИЯ ЦЕЛ  GetInpMsgNumber_GUI (ПУСТО);  /* чтение числа сообщ. во входн. буфере - не исползуется*/
  268          ФУНКЦИЯ ЦЕЛ  GetOutMsgNumber_GUI (ПУСТО); /* чтение числа сообщ. в выходн. буфере -  не исползуется*/
  269          
  270          ФУНКЦИЯ ПЛАВ GetFP_P_BAK_COMPRESSOR		(ПУСТО);	/* чтение давления в баке компрессора */ 
  271          ФУНКЦИЯ ПЛАВ GetFP_P_PATRUBKA			(ПУСТО);   /* чтение давления  в патрубке      */
  272          ФУНКЦИЯ ПЛАВ GetFP_T_RUBACHKA			(ПУСТО);	/* чтение температуры воды в рубашке охлаждения */
  273          ФУНКЦИЯ ПЛАВ GetFP_T_BAK				(ПУСТО);	/* чтение температуры воды в баке охлаждения */ 
  274          ФУНКЦИЯ ПЛАВ GetFP_P_TRUBA				(ПУСТО);	/* чтение давления в трубе сидера */
  275          
  276          
  277          /*###########################################################*/
  278          /*########                                          #########*/
  279          /*########  ОПИСАНИЕ РЕГИСТРОВ МОДУЛЕЙ УСО          #########*/
  280          /*########  (устройство связи с объектом)           #########*/
  281          /*###########################################################*/
  282          
  283          ВХОД  ЛОГ_ВХОД_ОТКР_ЗАТВОР_ВАК  0 0 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  284          ВХОД  ЛОГ_ВХОД_ЗАКР_ЗАТВОР_ВАК  0 1 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  285          ВХОД  ЛОГ_ВХОД_САПУН  			0 2 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  286          ВХОД  ЛОГ_ВХОД_УСТР_ПЛАВ_ПУСКА  0 3 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  287          ВХОД  ЛОГ_ВХОД_ПИТ_ВАК_НАСОСА  	0 4 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  288          ВХОД  ЛОГ_ВХОД_ПИТ_ВЕНТИЛЯТОРА  0 5 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  289          ВХОД  ЛОГ_ВХОД_ПИТ_РЕГ_Т  		0 6 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  290          ВХОД  ЛОГ_ВХОД_ПИТ_РЕГ_УР  		0 7 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  291          ВХОД  ЛОГ_ВХОД_УР_ВОДЫ_MIN  	0 8 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  292          ВХОД  ЛОГ_ВХОД_УР_ВОДЫ_MAX  	0 9 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  293          ВХОД  ЛОГ_ВХОД_ПИТ_НАСОС_ОХЛ  	0 10 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  294          
  295          
  296          /* ВХОД АЦП_T_Вбаке		 			0 66 16; */  /* регистр АЦП */
  297          /*ВХОД АЦП_T_Врубашке	 			0 67 16; */ /* регистр АЦП */
  298          /*ВХОД АЦП_P_ВтрубеСидер	 		0 68 16; */ /* регистр АЦП */
  299          /*ВХОД АЦП_P_Впатрубке 				0 69 16; */ /*   регистр АЦП */
  300          /*ВХОД АЦП_P_ВбакеКомпрессора 		0 70 16; */ /* регистр АЦП */
  301          
  302          
  303          ВЫХОД  ЛОГ_ВЫХОД_GPIO20  1 0 8; /* имя, базовый адрес, доп. адр. порта, 8бит */
  304          /*ВЫХОД  ЛОГ_ВЫХОД_GPIO21  1 1 8; */ /* имя, базовый адрес, доп. адр. порта, 8бит */
  305          
  306          
  307          /*###########################################################*/
  308          /*########                                          #########*/
  309          /*########  ПРОЦЕССЫ                                #########*/
  310          /*########                                          #########*/
  311          /*###########################################################*/
  312          
  313          /*
  314           * Процесс Инициализация. Служит для
  315           * развертывания программы. Этот процесс (описанный
  316           * первым) - единственно активный процесс по запуску.
  317           * Кроме этого, процесс Инициализация содержит описание 
  318           * переменных для ссылок из других
  319           * процессов. Это удобно: описания локализованы в одном
  320           * месте.
  321          */
  322          
  323          ПРОЦ Инициализация{
  324          /*===========================================================*/
  325          /*=========== ОПИСАНИЕ ПЕРЕМЕННЫХ ===========================*/
  326          /*===========================================================*/
  327          
  328          /* ВХОДНЫЕ СИГНАЛЫ: */
  329          /*-----------------*/
  330          
  331          
  332          ЛОГ К_ОТКР_ЗАТВОР_ВАК             	= {ЛОГ_ВХОД_ОТКР_ЗАТВОР_ВАК[1]} ДЛЯ ВСЕХ; /*  концевик затвора вакуумного*/
  333          ЛОГ Д_ОТКР_ЗАТВОР_ВАК             	= {ЛОГ_ВХОД_ОТКР_ЗАТВОР_ВАК[1]} ДЛЯ ВСЕХ; /*  достоверность*/
  334          
  335          ЛОГ К_ЗАКР_ЗАТВОР_ВАК             	= {ЛОГ_ВХОД_ЗАКР_ЗАТВОР_ВАК[1]} ДЛЯ ВСЕХ; /*  концевик затвора вакуумного*/
  336          ЛОГ Д_ЗАКР_ЗАТВОР_ВАК             	= {ЛОГ_ВХОД_ЗАКР_ЗАТВОР_ВАК[1]} ДЛЯ ВСЕХ;
  337          
  338          ЛОГ К_САПУН                         = {ЛОГ_ВХОД_САПУН[1]} ДЛЯ ВСЕХ;
  339          ЛОГ Д_САПУН                         = {ЛОГ_ВХОД_САПУН[1]} ДЛЯ ВСЕХ;
  340          
  341          ЛОГ К_УСТР_ПЛАВ_ПУСКА				= {ЛОГ_ВХОД_УСТР_ПЛАВ_ПУСКА[1]} ДЛЯ ВСЕХ;
  342          ЛОГ Д_УСТР_ПЛАВ_ПУСКА				= {ЛОГ_ВХОД_УСТР_ПЛАВ_ПУСКА[1]} ДЛЯ ВСЕХ;
  343          
  344          ЛОГ К_ПИТ_ВАК_НАСОСА			 	= {ЛОГ_ВХОД_ПИТ_ВАК_НАСОСА[1]} ДЛЯ ВСЕХ; 
  345          ЛОГ Д_ПИТ_ВАК_НАСОСА			 	= {ЛОГ_ВХОД_ПИТ_ВАК_НАСОСА[1]} ДЛЯ ВСЕХ; 
  346          
  347          ЛОГ К_ПИТ_ВЕНТИЛЯТОРА               = {ЛОГ_ВХОД_ПИТ_ВЕНТИЛЯТОРА[1]} ДЛЯ ВСЕХ; 
  348          ЛОГ Д_ПИТ_ВЕНТИЛЯТОРА               = {ЛОГ_ВХОД_ПИТ_ВЕНТИЛЯТОРА[1]} ДЛЯ ВСЕХ; 
  349          
  350          ЛОГ К_ПИТ_РЕГ_Т 			        = {ЛОГ_ВХОД_ПИТ_РЕГ_Т[1]} ДЛЯ ВСЕХ;
  351          ЛОГ Д_ПИТ_РЕГ_Т 			        = {ЛОГ_ВХОД_ПИТ_РЕГ_Т[1]} ДЛЯ ВСЕХ;
  352          
  353          ЛОГ К_ПИТ_РЕГ_УР     				= {ЛОГ_ВХОД_ПИТ_РЕГ_УР[1]} ДЛЯ ВСЕХ;
  354          ЛОГ Д_ПИТ_РЕГ_УР     				= {ЛОГ_ВХОД_ПИТ_РЕГ_УР[1]} ДЛЯ ВСЕХ;
  355          
  356          ЛОГ К_УР_ВОДЫ_MIN  					= {ЛОГ_ВХОД_УР_ВОДЫ_MIN[1]} ДЛЯ ВСЕХ;
  357          ЛОГ Д_УР_ВОДЫ_MIN  					= {ЛОГ_ВХОД_УР_ВОДЫ_MIN[1]} ДЛЯ ВСЕХ;
  358          
  359          ЛОГ К_УР_ВОДЫ_MAX   				= {ЛОГ_ВХОД_УР_ВОДЫ_MAX[1]} ДЛЯ ВСЕХ;
  360          ЛОГ Д_УР_ВОДЫ_MAX   				= {ЛОГ_ВХОД_УР_ВОДЫ_MAX[1]} ДЛЯ ВСЕХ;
  361          
  362          ЛОГ К_ПИТ_НАСОС_ОХЛ 				= {ЛОГ_ВХОД_ПИТ_НАСОС_ОХЛ[1]} ДЛЯ ВСЕХ;
  363          ЛОГ Д_ПИТ_НАСОС_ОХЛ 				= {ЛОГ_ВХОД_ПИТ_НАСОС_ОХЛ[1]} ДЛЯ ВСЕХ;
  364          
  365          
  366          /* ВЫХОДНЫЕ СИГНАЛЫ (т.к. привязаны к модулю выходов): */ 
  367          
  368          ЛОГ У_ПИТ_ВЕНТИЛЯТОРА   			= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ; 
  369          ЛОГ У_ПИТ_РЕГ_Т      				= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ;            
  370          ЛОГ У_ПИТ_НАС_ОХЛ					= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ; 
  371          ЛОГ У_ПИТ_ВАК_НАСОСА       			= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ;                    
  372          ЛОГ У_ЗАТВОР_ВАК					= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ; 
  373          ЛОГ У_САПУН 						= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ;
  374          ЛОГ У_УСТР_ПЛАВ_ПУСКА        		= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ;                   
  375          ЛОГ У_ПИТ_РЕГ_УР      				= {ЛОГ_ВЫХОД_GPIO20[1]} ДЛЯ ВСЕХ; 
  376          	
  377          /* ЛОГ ОШИБКА_ФУНКЦИОНИРОВАНИЯ  		= {ЛОГ_ВЫХОД_GPIO5[1]} ДЛЯ ВСЕХ; */ /*резерв */
  378          /* предложение Саши Курочкина: ввести ошибку функционирования для контроля всех устройств, */
  379          /* составляющих вакуумную подсистему. Если Саша не достучится до них, или две единички одновременно */
  380          /* увидит у себя (ВКЛ/ВЫКЛ, например вентилятор). Правда, что в этом случае делать D2 - непонятно*/
  381          /* Предлагается ошибку функционирования обнулять перед каждым запуском соответствующего процесса */ 
  382          /* например: ВКЛ_ПИТ_ВЕНТИЛЯТОР, ВЫК_ПИТ_ВЕНТИЛЯТОР*/
  383          /* И еще, для каждой ошибки функционирования будет int - код ошибки */
  384          /* И еще, Саша говорит, что при обнаружении ош. функционирования надо прекращать вакуумирование ???*/
  385          
  386          /*ЛОГ ОШИБКА_ФУНКЦ_ЗАТВОР_ВАК 			= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  387          /*ЛОГ ОШИБКА_ФУНКЦ_САПУН 					= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  388          /*ЛОГ ОШИБКА_ФУНКЦ_УСТР_ПЛАВ_ПУСКА 		= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  389          /*ЛОГ ОШИБКА_ФУНКЦ_ПИТ_ВАК_НАСОСА 		= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  390          /*ЛОГ ОШИБКА_ФУНКЦ_ВЕНТИЛЯТОР 			= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  391          /*ЛОГ ОШИБКА_ФУНКЦ_ПИТ_РЕГ_Т 				= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  392          /*ЛОГ ОШИБКА_ФУНКЦ_ПИТ_РЕГ_УР 			= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  393          /*ЛОГ ОШИБКА_ФУНКЦ_НАСОС_ОХЛ 				= {ЛОГ_ВХОД_GPIO6[1]} ДЛЯ ВСЕХ;*/
  394          
  395          
  396          /*===========================================================*/
  397          /*=========== ЯЧЕЙКИ ИНФОРМАЦИОННЫХ КАНАЛОВ =================*/
  398          /*===========================================================*/
  399          ЦЕЛ КодСобытия_от_ГУИ        ДЛЯ ВСЕХ;
  400          ЦЕЛ КодСобытия_к_ГУИ         ДЛЯ ВСЕХ;
  401          
  402            
  403            
  404          /*===========================================================*/
  405          /*=========== ЯЧЕЙКИ ОБЩЕГО УПРАВЛЕНИЯ ======================*/
  406          /*===========================================================*/
  407          ЛОГ ФлагГотовУрВодыБО ДЛЯ ВСЕХ;  /* Флаг установлен, если уровень воды в баке охлаждения в норме*/ 
  408          ЛОГ ФлагГотовТемпВодыБО ДЛЯ ВСЕХ;  /* Флаг установлен, если  температура в баке охлаждения в норме*/ 
  409          ЛОГ ФлагГотовTВодыРО ДЛЯ ВСЕХ;  /* Флаг установлен, если  температура в рубашке охлаждения в норме*/ 
  410          ЛОГ ФлагГотовВакуумаВТ ДЛЯ ВСЕХ;
  411          ЛОГ ФлагОткачкиТрубыСидеростата ДЛЯ ВСЕХ;
  412          ЛОГ ФлагДавленияКомпрессора ДЛЯ ВСЕХ;
  413          
  414          ДЦЕЛ ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА ДЛЯ ВСЕХ; /* ????????чтобы в отмену не уходить */
  415          
  416          
  417          /*===========================================================*/
  418          /*=========== ФАКТИЧЕСКИЕ ПАРАМЕТРЫ =========================*/
  419          /*===========================================================*/
  420          /*ПЛАВ ФП_Pтрубы ДЛЯ ВСЕХ;*/
  421          /* ????????????????????????????????????????????????????????????????? */
  422          /*  Саша Курочкин будет ацепировать */
  423          /*ЦЕЛ	ФП_P_ВбакеКомпрессора 	= {P_ВбакеКомпрессора [16]} 	ДЛЯ ВСЕХ; */
  424          /*ЦЕЛ	ФП_P_Впатрубке	 		= {P_Впатрубке [16]}			ДЛЯ ВСЕХ; 	*/
  425          /*ЦЕЛ	ФП_T_Врубашке 			= {T_Врубашке [16]}				ДЛЯ ВСЕХ; 	*/
  426          /*ЦЕЛ	ФП_T_Вбаке 				= {T_Вбаке [16]}				ДЛЯ ВСЕХ;	*/ 
  427          /*ЦЕЛ	ФП_P_ВтрубеСидер 		= {P_ВтрубеСидер [16]} 			ДЛЯ ВСЕХ; 	*/
  428          
  429          
  430          ПЛАВ ФП_P_ВбакеКомпрессора ДЛЯ ВСЕХ; 
  431          ПЛАВ ФП_P_Впатрубке ДЛЯ ВСЕХ;
  432          ПЛАВ ФП_T_Врубашке ДЛЯ ВСЕХ;	
  433          ПЛАВ ФП_T_Вбаке ДЛЯ ВСЕХ;
  434          
  435          /*ПЛАВ ЗД_P_ВтрубеСидер ДЛЯ ВСЕХ;	*/
  436          ПЛАВ ФП_P_ВтрубеСидер ДЛЯ ВСЕХ;
  437          /*===========================================================*/
  438          /*============       НАСТРОЕЧНЫЕ ПАРАМЕТРЫ        ===========*/
  439          /*===========================================================*/
  440          ПЛАВ НП_P_ВбакеКомпрессора  ДЛЯ ВСЕХ;
  441          ПЛАВ НП_Pатмосф             ДЛЯ ВСЕХ;
  442          ПЛАВ НП_ГлубокийВакуумТрубы ДЛЯ ВСЕХ;
  443          
  444          
  445          /*########  СОСТОЯНИЯ ПРОЦЕССА  #########*/
  446           СОСТ Начало{  
  447          	ЕСЛИ (Д_ОТКР_ЗАТВОР_ВАК)  В СЛЕДУЮЩЕЕ;  /* проверяю один параметр. Все будут достоверны или наоборот*/
  448           }
  449          
  450          СОСТ НачалоРаботы{	
  451          /*    ОШИБКА_ФУНКЦИОНИРОВАНИЯ = ВЫК;  */
  452              ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА = 1; /* параметр регулирует частоту подачи */
  453          	                                   /* сообщений в зависимости от заполненности буфера сообщений... */
  454          /*===========================================================*/
  455          /*=================== ИНИЦИАЛИЗАЦИЯ ФЛАГОВ   ================*/
  456          /*===========================================================*/	
  457          /*	ФлагГотовУрВодыБО  = ВНЕ_НОРМЫ;  */
  458          /*	ФлагГотовТемпВодыБО = ВНЕ_НОРМЫ; */
  459          /*	ФлагГотовTВодыРО = ВНЕ_НОРМЫ;  */
  460          /*	ФлагГотовВакуумаВТ = ВНЕ_НОРМЫ; */
  461          /*	ФлагОткачкиТрубыСидеростата = ВНЕ_НОРМЫ; */
  462          /*	ФлагДавленияКомпрессора = ВНЕ_НОРМЫ; */
  463          /*===========================================================*/
  464          
  465          
  466          /*	У_ПИТ_ВЕНТИЛЯТОРА   			= ВЫК; */
  467          /*	У_ПИТ_РЕГ_Т      				= ВЫК;  */          
  468          /*	У_ПИТ_НАС_ОХЛ					= ВЫК; */
  469          /*	У_ПИТ_ВАК_НАСОСА       			= ВЫК;  */                  
  470          /*	У_ЗАТВОР_ВАК					= ЗАКР; */
  471          /*	У_САПУН 						= ЗАКР; */
  472          /*	У_УСТР_ПЛАВ_ПУСКА        		= ВЫК;  */                 
  473          /*	У_ПИТ_РЕГ_УР      				= ВЫК; */
  474          
  475          /*===========================================================*/
  476          /*========= ИНИЦИАЛИЗАЦИЯ НАСТРОЕЧНЫХ ПАРАМЕТРОВ   ==========*/
  477          /*===========================================================*/
  478          
  479          	НП_P_ВбакеКомпрессора = 8; /*атмосфер (бар) */
  480          	НП_Pатмосф              = 760.00;
  481          	НП_ГлубокийВакуумТрубы =  0.02; /*мм. рт. ст*/
  482          
  483          
  484          
  485          /* СТАРТ ПРОЦ ЧтениеАЦП; */
  486              СТАРТ ПРОЦ РЕГУЛЯТОР_ТРАФИКА;
  487          	СТАРТ ПРОЦ ЧтениеФактПараметров_с_Датчиков;
  488          	СТАРТ ПРОЦ ЧтениеКольцевогоБуфера;
  489          	СТАРТ ПРОЦ КонтрольИзменения_ФП_P_ВбакеКомпрессора;
  490          	СТАРТ ПРОЦ КонтрольИзменения_ФП_P_Впатрубке;
  491          	СТАРТ ПРОЦ КонтрольИзменения_ФП_T_Врубашке;
  492          	СТАРТ ПРОЦ КонтрольИзменения_ФП_T_Вбаке;
  493          	СТАРТ ПРОЦ КонтрольИзменения_ФП_P_ВтрубеСидер;
  494          
  495          	ЕСЛИ (!К_ПИТ_РЕГ_Т) СТАРТ ПРОЦ ВКЛ_ПИТ_РЕГ_Т;   /* питание всегда включено. На всякий случай */
  496          	
  497          	СТАРТ ПРОЦ ВКЛ_ПИТ_РЕГ_УР;
  498          
  499          	
  500          	СТАРТ ПРОЦ КонтрольУровняВодыБакаОхлаждения;
  501          	СТАРТ ПРОЦ КонтрольТемпературыРубашкиОхлаждения;
  502          	СТАРТ ПРОЦ КонтрольДавленияВбакеКомпрессора;
  503          	СТАРТ ПРОЦ КонтрольГотовностиВакуума_в_Вакуумной_Трубе;	
  504          	СТАРТ ПРОЦ КонтрольТемпературыВодыБакаОхлаждения;	
  505          /*	СТАРТ ПРОЦ КонтрольОткачкиВауумнойТрубыСидеростата;	*/
  506          /*контроль откачки из вакуумной трубы запускаем в процессе ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ  */
  507          /*  останавливаем в процессе ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ, если затвор вакуумный закрылся*/
  508          	СТОП;
  509             }
  510          }
  511          /*==============не используется   представлен как вариант===*/
  512          /*== Процессы контроля достоверности параметров К       ==*/
  513          /*      от Курочкина  (от девайсиков)  непрерывно выдает сообщения    */
  514          /*========================================================*/
  515          ПРОЦ КонтрольДостоверностиОткрытияЗатвораВакуумного{
  516           ИЗ ПРОЦ Инициализация  ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА,
  517                                  Д_ОТКР_ЗАТВОР_ВАК;
  518          
  519           СОСТ Начало{
  520              ЕСЛИ (Д_ОТКР_ЗАТВОР_ВАК) {
  521                   ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО))  В СЛЕДУЮЩЕЕ;
  522              } ИНАЧЕ {
  523                   ЕСЛИ (SendMsgGUICode(ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО))  В СОСТ СменаСостоянияВЫКЛ;
  524              }
  525              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  526           }
  527          
  528           СОСТ СменаСостоянияВКЛ{
  529              ЕСЛИ (!Д_ОТКР_ЗАТВОР_ВАК)  В СОСТ ТрафикПауза;
  530           }
  531          
  532           СОСТ СменаСостоянияВЫКЛ{
  533              ЕСЛИ (Д_ОТКР_ЗАТВОР_ВАК)  В СОСТ ТрафикПауза;
  534           }
  535           СОСТ ТрафикПауза{
  536              ТАЙМАУТ ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА В СОСТ Начало;
  537           }
  538          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  539           СОСТ НарушениеСвязи {
  540                В СОСТ Начало;
  541           }
  542          }
  543          /*========================================================*/
  544          /*== Процессы контроля достоверности параметров К       ==*/
  545          /*      от Курочкина  (от девайсиков)                    */
  546          /*========================================================*/
  547          ПРОЦ КонтрольДостоверностиОткрЗатВакуумного{
  548           ИЗ ПРОЦ Инициализация  Д_ОТКР_ЗАТВОР_ВАК;
  549          
  550           СОСТ Начало {
  551                ЕСЛИ (Д_ОТКР_ЗАТВОР_ВАК == ДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  552                ИНАЧЕ В СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ;
  553           }
  554           СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ {
  555               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО)) В СЛЕДУЮЩЕЕ;
  556               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  557           }
  558           СОСТ ОжиданиеНедостоверности {
  559                ЕСЛИ (Д_ОТКР_ЗАТВОР_ВАК == НЕДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  560           }
  561           СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ {
  562               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО)) В СЛЕДУЮЩЕЕ;
  563               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  564           }
  565           СОСТ ОжиданиеЕстьДостоверность {
  566                ЕСЛИ (Д_ОТКР_ЗАТВОР_ВАК == ДОСТОВЕРНО) В СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ;
  567           }
  568          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  569           СОСТ НарушениеСвязи {
  570          	   В СОСТ Начало;
  571           }
  572          }
  573          /*===========================================ЗАКР_ЗАТВОР_ВАК=============*/
  574          ПРОЦ КонтрольДостоверностиЗакрЗатВакуумного{
  575           ИЗ ПРОЦ Инициализация  Д_ЗАКР_ЗАТВОР_ВАК;
  576          
  577           СОСТ Начало {
  578                ЕСЛИ (Д_ЗАКР_ЗАТВОР_ВАК == ДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  579                ИНАЧЕ В СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ;
  580           }
  581           СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ {
  582               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ЗАКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО)) В СЛЕДУЮЩЕЕ;
  583               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  584           }
  585           СОСТ ОжиданиеНедостоверности {
  586                ЕСЛИ (Д_ЗАКР_ЗАТВОР_ВАК == НЕДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  587           }
  588           СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ {
  589               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ЗАКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО)) В СЛЕДУЮЩЕЕ;
  590               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  591           }
  592           СОСТ ОжиданиеЕстьДостоверность {
  593                ЕСЛИ (Д_ЗАКР_ЗАТВОР_ВАК == ДОСТОВЕРНО) В СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ;
  594           }
  595          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  596           СОСТ НарушениеСвязи {
  597          	   В СОСТ Начало;
  598           }
  599          }
  600          /*===========================================Д_САПУН=============*/
  601          ПРОЦ КонтрольДостоверностиСостоянияСапуна{
  602           ИЗ ПРОЦ Инициализация  Д_САПУН;
  603          
  604           СОСТ Начало {
  605                ЕСЛИ (Д_САПУН == ДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  606                ИНАЧЕ В СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ;
  607           }
  608           СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ {
  609               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_САПУНА)) В СЛЕДУЮЩЕЕ;
  610               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  611           }
  612           СОСТ ОжиданиеНедостоверности {
  613                ЕСЛИ (Д_САПУН == НЕДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  614           }
  615           СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ {
  616               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_САПУНА)) В СЛЕДУЮЩЕЕ;
  617               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  618           }
  619           СОСТ ОжиданиеЕстьДостоверность {
  620                ЕСЛИ (Д_САПУН == ДОСТОВЕРНО) В СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ;
  621           }
  622          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  623           СОСТ НарушениеСвязи {
  624          	   В СОСТ Начало;
  625           }
  626          }
  627          
  628          /*===========================================Д_УСТР_ПЛАВ_ПУСКА=============*/
  629          ПРОЦ КонтрольДостоверностиСостоянияУстройстваПлавПуска{
  630           ИЗ ПРОЦ Инициализация  Д_УСТР_ПЛАВ_ПУСКА;
  631          
  632           СОСТ Начало {
  633                ЕСЛИ (Д_УСТР_ПЛАВ_ПУСКА == ДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  634                ИНАЧЕ В СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ;
  635           }
  636           СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ {
  637               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_УСТР_ПЛАВ_ПУСКА)) В СЛЕДУЮЩЕЕ;
  638               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  639           }
  640           СОСТ ОжиданиеНедостоверности {
  641                ЕСЛИ (Д_УСТР_ПЛАВ_ПУСКА == НЕДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  642           }
  643           СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ {
  644               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_УСТР_ПЛАВ_ПУСКА)) В СЛЕДУЮЩЕЕ;
  645               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  646           }
  647           СОСТ ОжиданиеЕстьДостоверность {
  648                ЕСЛИ (Д_УСТР_ПЛАВ_ПУСКА == ДОСТОВЕРНО) В СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ;
  649           }
  650          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  651           СОСТ НарушениеСвязи {
  652          	   В СОСТ Начало;
  653           }
  654          }
  655          /*===========================================Д_ПИТ_ВАК_НАСОСА=============*/
  656          ПРОЦ КонтрольДостоверностиСостоянияПитанияВакуумногоНасоса{
  657           ИЗ ПРОЦ Инициализация  Д_ПИТ_ВАК_НАСОСА;
  658          
  659           СОСТ Начало {
  660                ЕСЛИ (Д_ПИТ_ВАК_НАСОСА == ДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  661                ИНАЧЕ В СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ;
  662           }
  663           СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ {
  664               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ПИТ_ВАК_НАСОСА)) В СЛЕДУЮЩЕЕ;
  665               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  666           }
  667           СОСТ ОжиданиеНедостоверности {
  668                ЕСЛИ (Д_ПИТ_ВАК_НАСОСА == НЕДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  669           }
  670           СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ {
  671               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ПИТ_ВАК_НАСОСА)) В СЛЕДУЮЩЕЕ;
  672               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  673           }
  674           СОСТ ОжиданиеЕстьДостоверность {
  675                ЕСЛИ (Д_ПИТ_ВАК_НАСОСА == ДОСТОВЕРНО) В СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ;
  676           }
  677          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  678           СОСТ НарушениеСвязи {
  679          	   В СОСТ Начало;
  680           }
  681          }
  682          /*===========================================Д_ПИТ_ВЕНТИЛЯТОРА=============*/
  683          ПРОЦ КонтрольДостоверностиСостоянияПитанияВентилятора{
  684           ИЗ ПРОЦ Инициализация  Д_ПИТ_ВЕНТИЛЯТОРА;
  685          
  686           СОСТ Начало {
  687                ЕСЛИ (Д_ПИТ_ВЕНТИЛЯТОРА == ДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  688                ИНАЧЕ В СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ;
  689           }
  690           СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ {
  691               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ_КОНТРОЛЯ_ПИТ_ВЕНТИЛЯТОРА)) В СЛЕДУЮЩЕЕ;
  692               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  693           }
  694           СОСТ ОжиданиеНедостоверности {
  695                ЕСЛИ (Д_ПИТ_ВЕНТИЛЯТОРА == НЕДОСТОВЕРНО) В СЛЕДУЮЩЕЕ;
  696           }
  697           СОСТ СообК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ {
  698               ЕСЛИ (SendMsgGUICode(ПК_ГУИ_НЕТ_ДОСТОВЕРНОСТИ_КОНТРОЛЯ_ПИТ_ВЕНТИЛЯТОРА)) В СЛЕДУЮЩЕЕ;
  699               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  700           }
  701           СОСТ ОжиданиеЕстьДостоверность {
  702                ЕСЛИ (Д_ПИТ_ВЕНТИЛЯТОРА == ДОСТОВЕРНО) В СОСТ СообК_ГУИ_ЕСТЬ_ДОСТОВЕРНОСТЬ;
  703           }
  704          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  705           СОСТ НарушениеСвязи {
  706          	   В СОСТ Начало;
  707           }
  708          }
  709          
  710          
  711          
  712          /*Д_ЗАКР_ЗАТВОР_ВАК*/
  713          /*Д_САПУН */
  714          /*Д_УСТР_ПЛАВ_ПУСКА*/
  715          /*Д_ПИТ_ВАК_НАСОСА*/
  716          /*Д_ПИТ_ВЕНТИЛЯТОРА*/
  717          /*Д_ПИТ_РЕГ_Т  (дописать бы надо)
  718          Д_ПИТ_РЕГ_УР
  719          Д_УР_ВОДЫ_MIN
  720          Д_УР_ВОДЫ_MAX
  721          Д_ПИТ_НАСОС_ОХЛ */
  722          
  723          
  724          /*========================================================*/
  725          /*                                                        */
  726          /*==            ЧТЕНИЕ ФАКТИЧЕСКИХ ПАРАМЕТРОВ           ==*/
  727          /*                                                        */
  728          /*========================================================*/
  729          ПРОЦ ЧтениеФактПараметров_с_Датчиков{
  730          ИЗ ПРОЦ Инициализация ФП_P_ВбакеКомпрессора,
  731                                ФП_P_Впатрубке,
  732                                ФП_T_Врубашке,
  733                                ФП_T_Вбаке,
  734          					  ФП_P_ВтрубеСидер;
  735          
  736           СОСТ Начало {
  737          	ФП_P_ВбакеКомпрессора 	= GetFP_P_BAK_COMPRESSOR();     /* чтение давления в баке компрессора */
  738          	ФП_P_Впатрубке 		= GetFP_P_PATRUBKA();     			/* чтение давления  в патрубке      */
  739          	ФП_T_Врубашке 		= GetFP_T_RUBACHKA();     			/* чтение температуры воды в рубашке охлаждения */   
  740          	ФП_T_Вбаке 			= GetFP_T_BAK();     				/* чтение температуры воды в баке охлаждения */ 
  741          	ФП_P_ВтрубеСидер 	= GetFP_P_TRUBA();     				/* чтение давления в трубе сидера */ 
  742             В СОСТ Начало;
  743           }
  744          }
  745          
  746          /*=============================================================*/
  747          /*=         РЕГУЛЯТОР ТРАФИКА                    ==============*/
  748          /*=         ЕСЛИ КАНАЛЫ ЗАБИТЫ, ТО                           ==*/
  749          /*=         УВЕЛИЧИВАЕТСЯ ВРЕМЯ МЕЖДУ                        ==*/
  750          /*=         СЕРВЕРОМ И ВЫДАЧЕЙ В GUI                         ==*/
  751          /*=         ФАКТИЧЕСКИХ ПАРАМЕТРОВ                           ==*/
  752          /*= GetOutMsgNumber_GUI читает число сообщ. в выходн. буфере ==*/
  753          /*=============================================================*/
  754          ПРОЦ РЕГУЛЯТОР_ТРАФИКА{
  755           ИЗ ПРОЦ Инициализация ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА;
  756           СОСТ Начало{
  757              ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА = GetOutMsgNumber_GUI()/5 + 1;  /*динамический таймаут*/
  758              ЗАЦИКЛИТЬ;
  759           }
  760          }
  761          
  762          
  763          
  764          
  765          
  766          
  767          /*==============================================*/
  768          /*==============================================*/
  769          /*=                                            =*/
  770          /*=      ПРОЦЕСС ЧтениеКольцевогоБуфера        =*/
  771          /*=                                            =*/
  772          /*==============================================*/
  773          /*==============================================*/
  774          ПРОЦ ЧтениеКольцевогоБуфера{
  775          ИЗ ПРОЦ Инициализация
  776                                  КодСобытия_от_ГУИ;       /* */
  777          
  778           СОСТ Начало{
  779              /*  читаем код и параметр события из кольцевого буфера в структуру */
  780              ЕСЛИ (GetNextMsgGUI()) {
  781                КодСобытия_от_ГУИ = GetMsgGUICode();
  782                      ЕСЛИ ((КодСобытия_от_ГУИ >= КОМ_ГУИ_ОТКР_ЗАТВОР_ВАК) &&
  783                            (КодСобытия_от_ГУИ <= КОМАНДЫ_ОТ_ГУИ)) {
  784          				СТАРТ ПРОЦ ОбработкаКомандУправления_от_ГУИ;
  785          				В СОСТ КонтрольВыполненияК;
  786                      } 
  787          			ИНАЧЕ ЕСЛИ ((КодСобытия_от_ГУИ >= ИЗМН_НП_1) &&
  788                                   (КодСобытия_от_ГУИ <= ИЗМН_НП_N)) {
  789                               СТАРТ ПРОЦ ОбработкаКомандИзмененияНП_от_ГУИ;
  790                               В СОСТ КонтрольИзмененияНП;
  791          			}
  792          			ИНАЧЕ В СОСТ НекорректноеСобытие;
  793              }
  794           } 
  795           
  796           СОСТ КонтрольВыполненияК{
  797              ЕСЛИ(ПРОЦ ОбработкаКомандУправления_от_ГУИ В СОСТ ПАССИВНОЕ)
  798              В СОСТ Начало;
  799           }
  800            СОСТ КонтрольИзмененияНП{
  801              ЕСЛИ(ПРОЦ ОбработкаКомандИзмененияНП_от_ГУИ В СОСТ ПАССИВНОЕ)
  802              В СОСТ Начало;
  803           }
  804            /*===== НЕНОРМАЛЬНЫЕ СИТУАЦИИ === */
  805            СОСТ НекорректноеСобытие{
  806               ЕСЛИ (SendMsgLongParamGUI(ПК_ГУИ_ОШИБКА_КОДА_КОМАНДЫ_ОТ_ГУИ, КодСобытия_от_ГУИ))
  807                 В СОСТ Начало;
  808               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  809           }
  810          
  811           СОСТ НарушениеСвязи {
  812          	В СОСТ Начало;
  813               СТОП;   /* м.б. в начало?!!!!!!!!!!!!!! что я и сделал*/
  814           }
  815          }
  816          /*===================================================*/
  817          /*==                                               ==*/
  818          /*==  ПРОЦЕСС ИЗМЕНЕНИЯ НАСТРОЕЧНЫХ ПАРАМЕТРОВ     ==*/
  819          /*==                                               ==*/
  820          /*===================================================*/
  821          ПРОЦ ОбработкаКомандИзмененияНП_от_ГУИ{
  822          ИЗ ПРОЦ Инициализация 	КодСобытия_от_ГУИ,
  823          						КодСобытия_к_ГУИ,
  824          						НП_Pатмосф,
  825          						НП_ГлубокийВакуумТрубы,
  826          						НП_P_ВбакеКомпрессора;
  827          ПЛАВ ЛП_Параметр_к_ПИВ ЛОКАЛ;
  828           СОСТ Анализ{
  829              РАЗБОР (КодСобытия_от_ГУИ) {
  830          	    СЛУЧАЙ ИЗМН_НП_Pатмосф:
  831                    НП_Pатмосф  = GetFloatParamGUI();
  832                    КодСобытия_к_ГУИ = ИЗМН_НП_Pатмосф;
  833                    В СОСТ ПодтверждениеИзмененияНП;
  834          			КОНЕЦ;
  835          	    СЛУЧАЙ ИЗМН_НП_P_ВбакеКомпрессора:
  836          		   НП_P_ВбакеКомпрессора  = GetFloatParamGUI();
  837                    КодСобытия_к_ГУИ = НП_P_ВбакеКомпрессора;
  838                    В СОСТ ПодтверждениеИзмененияНП;		   
  839          			КОНЕЦ;
  840          	    СЛУЧАЙ ИЗМН_НП_ГлубокийВакуумТрубы:
  841          		   НП_ГлубокийВакуумТрубы  = GetFloatParamGUI();
  842                    КодСобытия_к_ГУИ = НП_ГлубокийВакуумТрубы;
  843                    В СОСТ ПодтверждениеИзмененияНП;		   
  844          			КОНЕЦ;
  845          		УМОЛЧАНИЕ:
  846                    В СОСТ НекорректноеСобытие;
  847                    КОНЕЦ;
  848              } /* конец разбора */
  849          	СТОП;	
  850          
  851           }
  852           СОСТ ПодтверждениеИзмененияНП{
  853              ЕСЛИ (SendMsgLongParamGUI(КодСобытия_к_ГУИ, GetLongParamGUI())) СТОП;
  854              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  855           }
  856           /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
  857           СОСТ НекорректноеСобытие {
  858              ЕСЛИ (SendMsgLongParamGUI(ПК_ГУИ_ОШИБКА_КОДА_КОМАНДЫ_ОТ_ГУИ, КодСобытия_от_ГУИ))
  859                   СТОП;
  860              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
  861           }
  862            СОСТ НарушениеСвязи {
  863              ОШИБКА;
  864           }
  865          }
  866          /*=========================================*/
  867          /*=                                       =*/
  868          /*=     ОБРАБОТКА КОМАНД ОТ ГУИ           =*/
  869          /*=                                       =*/
  870          /*=========================================*/
  871          ПРОЦ ОбработкаКомандУправления_от_ГУИ{
  872          ИЗ ПРОЦ Инициализация
  873          						/*	ТекущийРежим,*/
  874                              КодСобытия_от_ГУИ,
  875          					К_УСТР_ПЛАВ_ПУСКА,
  876          					ФлагГотовУрВодыБО,
  877          					ФП_T_Вбаке,
  878          					К_ПИТ_ВЕНТИЛЯТОРА,
  879          					К_ПИТ_НАСОС_ОХЛ,
  880          					К_ОТКР_ЗАТВОР_ВАК,
  881          					К_ЗАКР_ЗАТВОР_ВАК,
  882          					К_САПУН,
  883          					ФлагГотовTВодыРО,
  884          					ФП_P_ВтрубеСидер,
  885          					ФП_P_Впатрубке,
  886          					НП_Pатмосф;
  887          ЦЕЛ ЛП_КодСообщенияДляGUI ЛОКАЛ;
  888          
  889           СОСТ Анализ{
  890              РАЗБОР (КодСобытия_от_ГУИ) {
  891          	
  892          	    СЛУЧАЙ КОМ_ГУИ_ОТКР_ЗАТВОР_ВАК:
  893          		  ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) { /* вакуумирования нет */
  894          				ЕСЛИ ((ФП_P_ВтрубеСидер >= ФП_P_Впатрубке)
  895          					|| (ФП_P_ВтрубеСидер >= НП_Pатмосф))   /* можно открывать */
  896          					СТАРТ ПРОЦ ОТКР_ЗАТВОР_ВАК; 
  897          				ИНАЧЕ {
  898          					ЛП_КодСообщенияДляGUI = ПК_ГУИ_НЕТ_УСЛОВИЙ_ДЛЯ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  899          					В СОСТ ПередачаСообщенияСПараметромГУИ;
  900          				}			
  901          		  } ИНАЧЕ {
  902          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  903          			В СОСТ ПередачаСообщенияСПараметромГУИ;
  904          		  }		
  905          		КОНЕЦ;
  906          
  907          	    СЛУЧАЙ КОМ_ГУИ_ЗАКР_ЗАТВОР_ВАК:
  908          		  ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) { /* вакуумирование не включено*/
  909          			СТАРТ ПРОЦ ЗАКР_ЗАТВОР_ВАК; 
  910          		  } ИНАЧЕ {
  911          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  912          			В СОСТ ПередачаСообщенияСПараметромГУИ;
  913          		  }		
  914          			КОНЕЦ;		  
  915          	    СЛУЧАЙ КОМ_ГУИ_ОТКР_САПУН:
  916          		  ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) { /* вакуумирование не включено*/
  917          			СТАРТ ПРОЦ ОТКР_САПУН; 
  918          		  } ИНАЧЕ {
  919          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  920          			В СОСТ ПередачаСообщенияСПараметромГУИ;
  921          		  }
  922          		  КОНЕЦ;
  923          	    СЛУЧАЙ КОМ_ГУИ_ЗАКР_САПУН:
  924          		  ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) { /* вакуумирование не включено*/
  925          			СТАРТ ПРОЦ ЗАКР_САПУН; 
  926          		  } ИНАЧЕ {
  927          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  928          			В СОСТ ПередачаСообщенияСПараметромГУИ;
  929          		  }
  930          		  КОНЕЦ;
  931          
  932          		СЛУЧАЙ КОМ_ГУИ_ВКЛ_УСТР_ПЛАВ_ПУСКА:
  933          			ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) { /* вакуумирование не включено*/
  934          				ЕСЛИ ((ФлагГотовУрВодыБО == НОРМА) && (К_ПИТ_ВЕНТИЛЯТОРА)
  935          						&& (К_ПИТ_НАСОС_ОХЛ)&& (К_ЗАКР_ЗАТВОР_ВАК) && (К_САПУН)
  936          						&& (ФлагГотовTВодыРО == НОРМА)) {   /* можно включать */
  937          						СТАРТ ПРОЦ ВКЛ_УСТР_ПЛАВ_ПУСКА;
  938          				} ИНАЧЕ {
  939          					ЛП_КодСообщенияДляGUI = ПК_ГУИ_НЕТ_УСЛОВИЙ_ДЛЯ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  940          					В СОСТ ПередачаСообщенияСПараметромГУИ;
  941          				}
  942          			} ИНАЧЕ {
  943          				ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  944          				В СОСТ ПередачаСообщенияСПараметромГУИ;
  945          			}			
  946          			КОНЕЦ;
  947          	
  948          			
  949          	    СЛУЧАЙ КОМ_ГУИ_ВЫК_УСТР_ПЛАВ_ПУСКА:   /* вопрос: надо ли вообще выключать его. М.б. достаточно выкл питание????*/
  950          			СТАРТ ПРОЦ ВЫК_УСТР_ПЛАВ_ПУСКА;
  951          			КОНЕЦ;	
  952          		СЛУЧАЙ КОМ_ГУИ_ВКЛ_ПИТ_ВАК_НАСОСА:			
  953                    СТАРТ ПРОЦ ВКЛ_ПИТ_ВАК_НАСОСА;
  954                    КОНЕЦ;
  955          	    СЛУЧАЙ КОМ_ГУИ_ВЫК_ПИТ_ВАК_НАСОСА:
  956                    СТАРТ ПРОЦ ВЫК_ПИТ_ВАК_НАСОСА;
  957                    КОНЕЦ;
  958          
  959          /*----------------------------------------------------------------------*/
  960          	    СЛУЧАЙ КОМ_ГУИ_ВКЛ_ПИТ_ВЕНТИЛЯТОР:
  961          			СТАРТ ПРОЦ ВКЛ_ПИТ_ВЕНТИЛЯТОР;
  962                    КОНЕЦ;
  963          	    СЛУЧАЙ КОМ_ГУИ_ВЫК_ПИТ_ВЕНТИЛЯТОР:
  964          			СТАРТ ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР;	
  965                    КОНЕЦ;			
  966          /*----------------------------------------------------------------------*/		  
  967          /*	    СЛУЧАЙ КОМ_ГУИ_ВКЛ_ПИТ_ВЕНТИЛЯТОР:*/
  968          /*		  ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) {  *//* вакуумирование не включено*/
  969          /*			СТАРТ ПРОЦ ВКЛ_ПИТ_ВЕНТИЛЯТОР; */
  970          /*		  } ИНАЧЕ {*/
  971          /*		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;*/
  972          /*			В СОСТ ПередачаСообщенияСПараметромГУИ;*/
  973          /*			}*/
  974          /*          КОНЕЦ;*/
  975          /*	    СЛУЧАЙ КОМ_ГУИ_ВЫК_ПИТ_ВЕНТИЛЯТОР:*/
  976          /*          ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) { *//* вакуумирование не включено*/
  977          /*			СТАРТ ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР; */
  978          /*		  } ИНАЧЕ { */ /* идет вакуумирование*/
  979          /*		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;*/
  980          /*			В СОСТ ПередачаСообщенияСПараметромГУИ;*/
  981          /*		  } */
  982          /*          КОНЕЦ;   */
  983          /*----------------------------------------------------------------------*/		  
  984          	    СЛУЧАЙ КОМ_ГУИ_ВКЛ_ПИТ_РЕГ_Т:
  985          		  ЕСЛИ(К_УСТР_ПЛАВ_ПУСКА == ВЫК) {   /* вакуумирование не включено*/
  986          		  
  987          /*				ЕСЛИ ((ФлагГотовУрВодыБО = НОРМА) && (ФП_T_Вбаке > 0.0)) СТАРТ ПРОЦ ВКЛ_ПИТ_РЕГ_Т;  */
  988          
  989          				ЕСЛИ (ФлагГотовУрВодыБО == НОРМА) {
  990          					ЕСЛИ (ФП_T_Вбаке > 0.0) {
  991          						СТАРТ ПРОЦ ВКЛ_ПИТ_РЕГ_Т;
  992          					} ИНАЧЕ {
  993          					 ЛП_КодСообщенияДляGUI = ПК_ГУИ_ОТРИЦАТЕЛЬНАЯ_ТЕМПЕРАТУРА_ВОДЫ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  994          					 В СОСТ ПередачаСообщенияСПараметромГУИ;
  995          					}
  996          				ЛП_КодСообщенияДляGUI = ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_ВНЕ_НОРМЫ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
  997          				В СОСТ ПередачаСообщенияСПараметромГУИ;				
  998          				}
  999          				
 1000          		  } ИНАЧЕ {   /* идет вакуумирование*/
 1001          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
 1002          			В СОСТ ПередачаСообщенияСПараметромГУИ;
 1003          		  }
 1004          		  КОНЕЦ;
 1005          	    СЛУЧАЙ КОМ_ГУИ_ВЫК_ПИТ_РЕГ_Т:
 1006          		  ЕСЛИ(К_УСТР_ПЛАВ_ПУСКА == ВЫК) {   /* вакуумирование не включено*/
 1007          			СТАРТ ПРОЦ ВЫК_ПИТ_РЕГ_Т;
 1008          		  } ИНАЧЕ {   /* идет вакуумирование*/
 1009          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
 1010          			В СОСТ ПередачаСообщенияСПараметромГУИ;
 1011          		  }
 1012                    КОНЕЦ;
 1013          	    СЛУЧАЙ КОМ_ГУИ_ВКЛ_ПИТ_РЕГ_УР:
 1014          		  ЕСЛИ(К_УСТР_ПЛАВ_ПУСКА == ВЫК) {   /* вакуумирование не включено*/
 1015          		  	СТАРТ ПРОЦ ВКЛ_ПИТ_РЕГ_УР;
 1016          		  } ИНАЧЕ {   /* идет вакуумирование*/
 1017          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
 1018          			В СОСТ ПередачаСообщенияСПараметромГУИ;
 1019          		  } 
 1020                    КОНЕЦ;
 1021          	    СЛУЧАЙ КОМ_ГУИ_ВЫК_ПИТ_РЕГ_УР:
 1022          		  ЕСЛИ(К_УСТР_ПЛАВ_ПУСКА == ВЫК) {   /* вакуумирование не включено*/
 1023          		  	СТАРТ ПРОЦ ВЫК_ПИТ_РЕГ_УР;
 1024          		  } ИНАЧЕ {   /* идет вакуумирование*/
 1025          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
 1026          			В СОСТ ПередачаСообщенияСПараметромГУИ;
 1027          		  } 
 1028          		  КОНЕЦ;
 1029          	    СЛУЧАЙ КОМ_ГУИ_ВКЛ_ПИТ_НАС_ОХЛ:
 1030          		  ЕСЛИ(К_УСТР_ПЛАВ_ПУСКА == ВЫК) {   /* вакуумирование не включено*/
 1031          				ЕСЛИ ((ФлагГотовУрВодыБО = НОРМА) && (ФП_T_Вбаке > 0.0)) СТАРТ ПРОЦ ВКЛ_ПИТ_НАС_ОХЛ;
 1032          		  } ИНАЧЕ {   /* идет вакуумирование*/
 1033          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
 1034          			В СОСТ ПередачаСообщенияСПараметромГУИ;
 1035          		  }
 1036          		  КОНЕЦ;
 1037          	    СЛУЧАЙ КОМ_ГУИ_ВЫК_ПИТ_НАС_ОХЛ:
 1038          		  ЕСЛИ(К_УСТР_ПЛАВ_ПУСКА == ВЫК) {   /* вакуумирование не включено*/
 1039          		  	СТАРТ ПРОЦ ВЫК_ПИТ_НАС_ОХЛ;
 1040          		  } ИНАЧЕ {   /* идет вакуумирование*/
 1041          		    ЛП_КодСообщенияДляGUI = ПК_ГУИ_ИДЕТ_ВАКУУМИРОВАНИЕ_ОТКАЗ_ВЫПОЛНЕНИЯ_КОМАНДЫ;
 1042          			В СОСТ ПередачаСообщенияСПараметромГУИ;
 1043          		  } 		
 1044          		  КОНЕЦ;
 1045          		  
 1046          	    СЛУЧАЙ КОМ_ГУИ_ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ:   
 1047                    СТАРТ ПРОЦ ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ; 
 1048                    КОНЕЦ;  
 1049          	    СЛУЧАЙ КОМ_ГУИ_ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ:  
 1050                    СТАРТ ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ; 
 1051                    КОНЕЦ;  
 1052          
 1053          		  СЛУЧАЙ КОМ_ГУИ_ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ:   /* достигает вакуума и выключает вак. насос и через 30 минут снова включает, если ва 1054          куума недостаточно */
 1055                    СТАРТ ПРОЦ ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ;
 1056                    КОНЕЦ;
 1057          		  
 1058          		  СЛУЧАЙ КОМ_ГУИ_ВЫК_ВАКУУМИРОВАНИЕ_ТРУБЫ:   
 1059          		  СТАРТ ПРОЦ ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ;
 1060                    КОНЕЦ;
 1061          		УМОЛЧАНИЕ:
 1062                    В СОСТ НекорректноеСобытие;
 1063                    КОНЕЦ;
 1064              } /* конец разбора */
 1065          	СТОП;
 1066           }
 1067          
 1068          
 1069           /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1070           СОСТ НекорректноеСобытие {
 1071              ЕСЛИ (SendMsgLongParamGUI(ПК_ГУИ_ОШИБКА_КОДА_КОМАНДЫ_ОТ_ГУИ, КодСобытия_от_ГУИ))
 1072                   СТОП;   
 1073              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1074           }
 1075           СОСТ ПередачаСообщенияСПараметромГУИ{
 1076              ЕСЛИ (SendMsgLongParamGUI(ЛП_КодСообщенияДляGUI, КодСобытия_от_ГУИ))
 1077                  СТОП;
 1078              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1079           }
 1080          
 1081           СОСТ НарушениеСвязи {
 1082              ОШИБКА;
 1083           }
 1084          } /* конец ПРОЦ ОбработкаКомандУправленияРегуляторами_от_ПИВ   */
 1085          
 1086          /*====================================================*/
 1087          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1088          /*==           изменения ФП_P_ВбакеКомпрессора        */
 1089          /*====================================================*/
 1090          ПРОЦ КонтрольИзменения_ФП_P_ВбакеКомпрессора{
 1091           ИЗ ПРОЦ Инициализация  ФП_P_ВбакеКомпрессора, ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА;
 1092           ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 1093           СОСТ Начало{
 1094              ЛП_Предыдущее = (!ФП_P_ВбакеКомпрессора);
 1095              В СЛЕДУЮЩЕЕ;
 1096           }
 1097           СОСТ КонтрольИзменения{
 1098              ЕСЛИ (ЛП_Предыдущее != ФП_P_ВбакеКомпрессора) {
 1099                   ЛП_Предыдущее = ФП_P_ВбакеКомпрессора;
 1100                   В СЛЕДУЮЩЕЕ;
 1101              }
 1102           }
 1103           СОСТ СообщОбИзменении{
 1104               ЕСЛИ (SendMsgFloatParamGUI(ПК_ГУИ_ФП_P_ВбакеКомпрессора, ЛП_Предыдущее))
 1105                   В СОСТ ТрафикПауза;
 1106               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1107           }
 1108           СОСТ ТрафикПауза{
 1109              ТАЙМАУТ ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА В СОСТ КонтрольИзменения;
 1110          
 1111           }
 1112          /* НЕНОРМАЛЬНЫЕ СИТУАЦИИ */
 1113           СОСТ НарушениеСвязи{
 1114               В СОСТ КонтрольИзменения;
 1115           }
 1116          }
 1117          /* ПРОЦ КонтрольИзменения_ФП_P_ВбакеКомпрессора  */
 1118          
 1119          /*====================================================*/
 1120          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1121          /*==           изменения ИЗМН_ФП_P_Впатрубке     */
 1122          /*====================================================*/
 1123          ПРОЦ КонтрольИзменения_ФП_P_Впатрубке{
 1124           ИЗ ПРОЦ Инициализация  ФП_P_Впатрубке, ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА;
 1125           ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 1126           СОСТ Начало{
 1127              ЛП_Предыдущее = (!ФП_P_Впатрубке);
 1128              В СЛЕДУЮЩЕЕ;
 1129           }
 1130           СОСТ КонтрольИзменения{
 1131              ЕСЛИ (ЛП_Предыдущее != ФП_P_Впатрубке) {
 1132                   ЛП_Предыдущее = ФП_P_Впатрубке;
 1133                   В СЛЕДУЮЩЕЕ;
 1134              }
 1135           }
 1136           СОСТ СообщОбИзменении{
 1137               ЕСЛИ (SendMsgFloatParamGUI(ПК_ГУИ_ФП_P_Впатрубке, ЛП_Предыдущее))
 1138                   В СОСТ ТрафикПауза;
 1139               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1140           }
 1141           СОСТ ТрафикПауза{
 1142              ТАЙМАУТ ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА В СОСТ КонтрольИзменения;
 1143          
 1144           }
 1145          /* НЕНОРМАЛЬНЫЕ СИТУАЦИИ */
 1146           СОСТ НарушениеСвязи{
 1147               В СОСТ КонтрольИзменения;
 1148           }
 1149          }
 1150          /* ПРОЦ КонтрольИзменения_ФП_P_Впатрубке  */
 1151          
 1152          /*====================================================*/
 1153          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1154          /*==           изменения ИЗМН_ФП_T_Врубашке     */
 1155          /*====================================================*/
 1156          ПРОЦ КонтрольИзменения_ФП_T_Врубашке{
 1157           ИЗ ПРОЦ Инициализация  ФП_T_Врубашке, ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА;
 1158           ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 1159           СОСТ Начало{
 1160              ЛП_Предыдущее = (!ФП_T_Врубашке);
 1161              В СЛЕДУЮЩЕЕ;
 1162           }
 1163           СОСТ КонтрольИзменения{
 1164              ЕСЛИ (ЛП_Предыдущее != ФП_T_Врубашке) {
 1165                   ЛП_Предыдущее = ФП_T_Врубашке;
 1166                   В СЛЕДУЮЩЕЕ;
 1167              }
 1168           }
 1169           СОСТ СообщОбИзменении{
 1170               ЕСЛИ (SendMsgFloatParamGUI(ПК_ГУИ_ФП_T_Врубашке, ЛП_Предыдущее))
 1171                   В СОСТ ТрафикПауза;
 1172               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1173           }
 1174           СОСТ ТрафикПауза{
 1175              ТАЙМАУТ ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА В СОСТ КонтрольИзменения;
 1176          
 1177           }
 1178          /* НЕНОРМАЛЬНЫЕ СИТУАЦИИ */
 1179           СОСТ НарушениеСвязи{
 1180               В СОСТ КонтрольИзменения;
 1181           }
 1182          }
 1183          /* ПРОЦ КонтрольИзменения_ФП_T_Врубашке  */
 1184          
 1185          /*====================================================*/
 1186          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1187          /*==           изменения ИЗМН_ФП_T_Вбаке     */
 1188          /*====================================================*/
 1189          ПРОЦ КонтрольИзменения_ФП_T_Вбаке{
 1190           ИЗ ПРОЦ Инициализация  ФП_T_Вбаке, ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА;
 1191           ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 1192           СОСТ Начало{
 1193              ЛП_Предыдущее = (!ФП_T_Вбаке);
 1194              В СЛЕДУЮЩЕЕ;
 1195           }
 1196           СОСТ КонтрольИзменения{
 1197              ЕСЛИ (ЛП_Предыдущее != ФП_T_Вбаке) {
 1198                   ЛП_Предыдущее = ФП_T_Вбаке;
 1199                   В СЛЕДУЮЩЕЕ;
 1200              }
 1201           }
 1202           СОСТ СообщОбИзменении{
 1203               ЕСЛИ (SendMsgFloatParamGUI(ПК_ГУИ_ФП_T_Вбаке, ЛП_Предыдущее))
 1204                   В СОСТ ТрафикПауза;
 1205               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1206           }
 1207           СОСТ ТрафикПауза{
 1208              ТАЙМАУТ ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА В СОСТ КонтрольИзменения;
 1209          
 1210           }
 1211          /* НЕНОРМАЛЬНЫЕ СИТУАЦИИ */
 1212           СОСТ НарушениеСвязи{
 1213               В СОСТ КонтрольИзменения;
 1214           }
 1215          }
 1216          /* ПРОЦ КонтрольИзменения_ФП_T_Вбаке  */
 1217          
 1218          /*====================================================*/
 1219          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1220          /*==           изменения ИЗМН_ФП_P_ВтрубеСидер     */
 1221          /*====================================================*/	
 1222           ПРОЦ КонтрольИзменения_ФП_P_ВтрубеСидер{
 1223           ИЗ ПРОЦ Инициализация  ФП_P_ВтрубеСидер, ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА;
 1224           ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 1225           СОСТ Начало{
 1226              ЛП_Предыдущее = (!ФП_P_ВтрубеСидер);
 1227              В СЛЕДУЮЩЕЕ;
 1228           }
 1229           СОСТ КонтрольИзменения{
 1230              ЕСЛИ (ЛП_Предыдущее != ФП_P_ВтрубеСидер) {
 1231                   ЛП_Предыдущее = ФП_P_ВтрубеСидер;
 1232                   В СЛЕДУЮЩЕЕ;
 1233              }
 1234           }
 1235           СОСТ СообщОбИзменении{
 1236               ЕСЛИ (SendMsgFloatParamGUI(ПК_ГУИ_ФП_P_ВтрубеСидер, ЛП_Предыдущее))
 1237                   В СОСТ ТрафикПауза;
 1238               ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1239           }
 1240           СОСТ ТрафикПауза{
 1241              ТАЙМАУТ ЗАДЕРЖКА_НА_РАЗГРУЗКУ_ТРАФИКА В СОСТ КонтрольИзменения;
 1242          
 1243           }
 1244          /* НЕНОРМАЛЬНЫЕ СИТУАЦИИ */
 1245           СОСТ НарушениеСвязи{
 1246               В СОСТ КонтрольИзменения;
 1247           }
 1248          }
 1249          /* ПРОЦ КонтрольИзменения_ФП_P_ВтрубеСидер  */   
 1250          
 1251          
 1252          /*====================================================*/
 1253          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1254          /*== 		Контроль Откачки в Трубе сидеростата 	==*/
 1255          /*====================================================*/
 1256          ПРОЦ КонтрольОткачкиВауумнойТрубыСидеростата{
 1257          ИЗ ПРОЦ Инициализация 	ФлагОткачкиТрубыСидеростата,
 1258          						ФП_P_ВтрубеСидер;
 1259          ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 1260          					
 1261           СОСТ Начало{
 1262          	ЛП_Предыдущее = ФП_P_ВтрубеСидер;
 1263          	ТАЙМАУТ ТАЙМАУТ_ЗАДЕРЖКА_НА_ОТКАЧКУ В СЛЕДУЮЩЕЕ;
 1264           }
 1265           СОСТ АнализОткачки{
 1266          	ЕСЛИ ((ФП_P_ВтрубеСидер - ЛП_Предыдущее) < -0.01) {    /*  величина откачки  ?????* м.б. настр параметр ввести*/
 1267                  ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СКОРОСТЬ_ОТКАЧКИ_В_НОРМЕ)) {
 1268          					ФлагОткачкиТрубыСидеростата = НОРМА;
 1269          					В СОСТ Начало;
 1270          		} 
 1271              } ИНАЧЕ{
 1272          	ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СКОРОСТЬ_ОТКАЧКИ_НИЖЕ_НОРМЫ)) {
 1273          					ФлагОткачкиТрубыСидеростата = ВНЕ_НОРМЫ;
 1274          					В СОСТ Начало;
 1275          		} 
 1276          	}
 1277           }
 1278          }
 1279          /*====================================================*/
 1280          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1281          /*== Контроль Готовности Вакуума в Вакуумной Трубе  ==*/
 1282          /*====================================================*/
 1283          
 1284          ПРОЦ КонтрольГотовностиВакуума_в_Вакуумной_Трубе{
 1285          ИЗ ПРОЦ Инициализация  	ФП_P_ВтрубеСидер,
 1286          						НП_ГлубокийВакуумТрубы,
 1287          						ФлагГотовВакуумаВТ;
 1288          СОСТ Начало{
 1289             ЕСЛИ (ФП_P_ВтрубеСидер <= НП_ГлубокийВакуумТрубы) {
 1290                   ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ДАВЛЕНИЕ_В_ВАКУУМНОЙ_ТРУБЕ_В_НОРМЕ)) {
 1291          					ФлагГотовВакуумаВТ = НОРМА;
 1292          					В СОСТ ДавлениеНормальное;
 1293          					}
 1294              
 1295              } ИНАЧЕ {
 1296                          ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ДАВЛЕНИЕ_В_ВАКУУМНОЙ_ТРУБЕ_ВНЕ_НОРМЫ)) {
 1297          					ФлагГотовВакуумаВТ = ВНЕ_НОРМЫ;
 1298          				   В СОСТ ДавлениеВысокое;
 1299          				}
 1300              }
 1301              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1302           }
 1303          
 1304          СОСТ ДавлениеНормальное{
 1305                 ЕСЛИ (ФП_P_ВтрубеСидер > 0.025)  В СОСТ Начало;
 1306           } 
 1307          СОСТ ДавлениеВысокое{
 1308                 ЕСЛИ (ФП_P_ВтрубеСидер < 0.01)  В СОСТ Начало;
 1309           }  
 1310           
 1311          СОСТ Задержка{
 1312                ТАЙМАУТ ОДНА_МИНУТА В СОСТ Начало;
 1313           }
 1314          /* НЕНОРМАЛЬНЫЕ СИТУАЦИИ */
 1315           СОСТ НарушениеСвязи{
 1316               В СОСТ Начало;
 1317           }
 1318          }
 1319          
 1320          /* конец ПРОЦ КонтрольГотовностиВакуума_в_Вакуумной Трубе
 1321          
 1322          /*====================================================*/
 1323          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1324          /*==           Уровень воды в баке охлаждения       ==*/
 1325          /*====================================================*/
 1326          ПРОЦ КонтрольУровняВодыБакаОхлаждения{
 1327           ИЗ ПРОЦ Инициализация
 1328                                  К_УР_ВОДЫ_MIN,
 1329                                  К_УР_ВОДЫ_MAX,
 1330          						ФлагГотовУрВодыБО;
 1331          						
 1332           СОСТ Начало{
 1333               ЕСЛИ (К_УР_ВОДЫ_MIN) {
 1334                   ЕСЛИ (SendMsgGUICode(ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_НИЗКИЙ)) {
 1335          					ФлагГотовУрВодыБО = ВНЕ_НОРМЫ;
 1336          					В СОСТ НизкийУровеньВоды;
 1337          					}
 1338              } ИНАЧЕ ЕСЛИ (К_УР_ВОДЫ_MAX) {
 1339                        ЕСЛИ (SendMsgGUICode(ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_ВЫСОКИЙ)) {
 1340          			   ФлагГотовУрВодыБО = ВНЕ_НОРМЫ;
 1341          			   В СОСТ ВысокийУровеньВоды;
 1342          			   }
 1343              } ИНАЧЕ {
 1344                          ЕСЛИ (SendMsgGUICode(ПК_ГУИ_УРОВЕНЬ_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_В_НОРМЕ)) {
 1345          					ФлагГотовУрВодыБО = НОРМА;
 1346          				   В СОСТ УровеньВодыВнорме;
 1347          				}
 1348                   }
 1349              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1350           }
 1351          
 1352           СОСТ НизкийУровеньВоды{
 1353                  ЕСЛИ (!К_УР_ВОДЫ_MIN)  В СОСТ Задержка;
 1354           }
 1355          
 1356           СОСТ ВысокийУровеньВоды{
 1357                 ЕСЛИ (!К_УР_ВОДЫ_MAX)  В СОСТ Задержка;
 1358           }
 1359           СОСТ УровеньВодыВнорме{
 1360          	   ЕСЛИ (К_УР_ВОДЫ_MIN && К_УР_ВОДЫ_MAX)  В СОСТ Задержка;
 1361           } 
 1362           
 1363          СОСТ Задержка{
 1364                ТАЙМАУТ ОДНА_МИНУТА В СОСТ Начало;
 1365           }
 1366           
 1367          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1368           СОСТ НарушениеСвязи {
 1369              В СОСТ Начало;
 1370           }
 1371          }   /*   Конец ПРОЦ КонтрольУровняВодыБакаОхлаждения */
 1372          
 1373          
 1374          /*====================================================*/
 1375          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1376          /*==       Температуры воды в баке охлаждения       ==*/
 1377          /*====================================================*/
 1378          ПРОЦ КонтрольТемпературыВодыБакаОхлаждения{
 1379           ИЗ ПРОЦ Инициализация 	
 1380          						ФП_T_Вбаке,	
 1381                                  ФлагГотовТемпВодыБО;
 1382          						
 1383           СОСТ Начало{
 1384              ЕСЛИ (ФП_T_Вбаке < 50) {
 1385                   ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_НИЗКАЯ)) {
 1386          					ФлагГотовТемпВодыБО = ВНЕ_НОРМЫ;
 1387          					В СОСТ НизкаяТемператураВоды;
 1388          					}
 1389              } ИНАЧЕ ЕСЛИ (ФП_T_Вбаке > 60) {
 1390                        ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_ВЫСОКАЯ)) {
 1391          			   ФлагГотовТемпВодыБО = ВНЕ_НОРМЫ;
 1392          			   В СОСТ ВысокаяТемператураВоды;
 1393          			   }
 1394              } ИНАЧЕ {
 1395                          ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_БАКЕ_ОХЛАЖДЕНИЯ_В_НОРМЕ)) {
 1396          					ФлагГотовТемпВодыБО = НОРМА;
 1397          				   В СОСТ ТемператураВнорме;
 1398          				}
 1399                   }
 1400          		 
 1401              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1402           }
 1403           
 1404          
 1405           СОСТ НизкаяТемператураВоды{
 1406                  ЕСЛИ (ФП_T_Вбаке > (50.0 + Т_ГИСТЕРЕЗИС_ВОДЫ_В_БАКЕ))  В СОСТ Начало;
 1407           }
 1408          
 1409           СОСТ ВысокаяТемператураВоды{
 1410                 ЕСЛИ (ФП_T_Вбаке < (60.0 - Т_ГИСТЕРЕЗИС_ВОДЫ_В_БАКЕ))  В СОСТ Начало;
 1411           }
 1412            СОСТ ТемператураВнорме{
 1413                 ЕСЛИ ((ФП_T_Вбаке < (50.0 - Т_ГИСТЕРЕЗИС_ВОДЫ_В_БАКЕ)) && 
 1414          	         (ФП_T_Вбаке > (60.0 + Т_ГИСТЕРЕЗИС_ВОДЫ_В_БАКЕ)))  В СОСТ Начало;
 1415           } 
 1416          СОСТ Задержка{
 1417          
 1418                ТАЙМАУТ ОДНА_МИНУТА В СОСТ Начало;
 1419           }
 1420           
 1421          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1422           СОСТ НарушениеСвязи {
 1423              В СОСТ Начало;
 1424           }
 1425          }   /*   Конец ПРОЦ КонтрольТемпературыВодыБакаОхлаждения */
 1426          
 1427          
 1428          /*====================================================*/
 1429          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1430          /*==       Температуры воды в рубашке охлаждения    ==*/
 1431          /*====================================================*/
 1432          ПРОЦ КонтрольТемпературыРубашкиОхлаждения{
 1433           ИЗ ПРОЦ Инициализация 	
 1434          						ФП_T_Врубашке,	
 1435                                  ФлагГотовTВодыРО;
 1436          						
 1437           СОСТ Начало{
 1438              ЕСЛИ (ФП_T_Врубашке < 40) {
 1439                   ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_РУБАШКЕ_ОХЛАЖДЕНИЯ_НИЗКАЯ)) {
 1440          					ФлагГотовTВодыРО = ВНЕ_НОРМЫ;
 1441          					В СОСТ НизкаяТемператураВоды;
 1442          					}
 1443              } ИНАЧЕ ЕСЛИ (ФП_T_Врубашке > 85) {
 1444                        ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_РУБАШКЕ_ОХЛАЖДЕНИЯ_ВЫСОКАЯ)) {
 1445          			   ФлагГотовTВодыРО = ВНЕ_НОРМЫ;
 1446          			   В СОСТ ВысокаяТемператураВоды;
 1447          			   }
 1448              } ИНАЧЕ {
 1449                          ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ТЕМПЕРАТУРА_ВОДЫ_В_РУБАШКЕ_ОХЛАЖДЕНИЯ_В_НОРМЕ)) {
 1450          					ФлагГотовTВодыРО = НОРМА;
 1451          				   В СОСТ ТемператураВнорме;
 1452          				}
 1453                   }
 1454              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1455           }
 1456          
 1457           СОСТ НизкаяТемператураВоды{
 1458                 
 1459          		ЕСЛИ (ФП_T_Врубашке > (40.0 + Т_ГИСТЕРЕЗИС_ВОДЫ_В_РУБАХЕ))  В СОСТ Начало;
 1460           }
 1461          
 1462           СОСТ ВысокаяТемператураВоды{
 1463                  ЕСЛИ (ФП_T_Врубашке < (85.0 - Т_ГИСТЕРЕЗИС_ВОДЫ_В_РУБАХЕ))  В СОСТ Начало;
 1464           }
 1465           
 1466          
 1467           СОСТ ТемператураВнорме{
 1468                  ЕСЛИ ((ФП_T_Врубашке < (40.0 - Т_ГИСТЕРЕЗИС_ВОДЫ_В_РУБАХЕ)) && 
 1469          	         (ФП_T_Врубашке > (85.0 + Т_ГИСТЕРЕЗИС_ВОДЫ_В_РУБАХЕ)))  В СОСТ Начало;
 1470           } 
 1471          СОСТ Задержка{
 1472                ТАЙМАУТ ОДНА_МИНУТА В СОСТ Начало;
 1473           }
 1474           
 1475          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1476           СОСТ НарушениеСвязи {
 1477              В СОСТ Начало;
 1478           }
 1479          }   /*   Конец ПРОЦ КонтрольТемпературыВодыВрубашкеОхлаждения */
 1480          
 1481          
 1482          /*====================================================*/
 1483          /*					ПРОЦЕСС КОНТРОЛЯ				  */
 1484          /*== 		Контроль давления в баке компрессора ??? 	==*/
 1485          /*====================================================*/
 1486          ПРОЦ КонтрольДавленияВбакеКомпрессора{
 1487          ИЗ ПРОЦ Инициализация  	ФП_P_ВбакеКомпрессора,
 1488          					ФлагДавленияКомпрессора,
 1489          					НП_P_ВбакеКомпрессора;
 1490          СОСТ Начало{
 1491             ЕСЛИ (ФП_P_ВбакеКомпрессора > НП_P_ВбакеКомпрессора) {
 1492                   ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ДАВЛЕНИЕ_В_БАКЕ_КОМПРЕССОРА_В_НОРМЕ)) {
 1493          					ФлагДавленияКомпрессора = НОРМА;
 1494          					В СОСТ ДавлениеНормальное;
 1495          					}
 1496              
 1497              } ИНАЧЕ {
 1498                          ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ДАВЛЕНИЕ_В_БАКЕ_КОМПРЕССОРА_НИЖЕ_НОРМЫ)) {
 1499          					ФлагДавленияКомпрессора = ВНЕ_НОРМЫ;
 1500          				   В СОСТ ДавлениеНизкое;
 1501          				}
 1502              }
 1503              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1504           }
 1505          
 1506          СОСТ ДавлениеНормальное{
 1507                 ЕСЛИ (ФП_P_ВбакеКомпрессора < 9.5)  В СОСТ Начало;
 1508           } 
 1509          СОСТ ДавлениеНизкое{
 1510                 ЕСЛИ (ФП_P_ВбакеКомпрессора < 10.5)  В СОСТ Начало;
 1511           }  
 1512           
 1513          СОСТ Задержка{
 1514                ТАЙМАУТ ОДНА_МИНУТА В СОСТ Начало;
 1515           }
 1516          /* НЕНОРМАЛЬНЫЕ СИТУАЦИИ */
 1517           СОСТ НарушениеСвязи{
 1518               В СОСТ Начало;
 1519           }
 1520          }
 1521          
 1522          
 1523          /*=========================================*/
 1524          /*=                                       =*/
 1525          /*=     ПРОЦЕССЫ  УПРАВЛЕНИЯ ВАКУУМНЫМ    =*/
 1526          /*=          ОБОРУДОВАНИЕМ                =*/
 1527          /*=========================================*/
 1528          /*=======================================================*/
 1529          /*=====   Процесс подачи питания на вентилятор		=====*/
 1530          /*=======================================================*/
 1531          ПРОЦ ВКЛ_ПИТ_ВЕНТИЛЯТОР{
 1532           ИЗ ПРОЦ Инициализация 	К_ПИТ_ВЕНТИЛЯТОРА,
 1533          						У_ПИТ_ВЕНТИЛЯТОРА,
 1534          						Д_ПИТ_ВЕНТИЛЯТОРА
 1535          					/*	ОШИБКА_ФУНКЦ_ВЕНТИЛЯТОР */
 1536          						;
 1537          					  
 1538           СОСТ Начало{
 1539             ЕСЛИ (ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР;
 1540             СТОП ПРОЦ КонтрольСпонтанногоВключенияВентилятора;
 1541          /*	ОШИБКА_ФУНКЦ_ВЕНТИЛЯТОР = НЕТ; */
 1542          	У_ПИТ_ВЕНТИЛЯТОРА = ВКЛ;
 1543          	В СЛЕДУЮЩЕЕ;      
 1544           }
 1545           СОСТ КонтрольВключения{
 1546          	ЕСЛИ ((К_ПИТ_ВЕНТИЛЯТОРА == ВКЛ) && (Д_ПИТ_ВЕНТИЛЯТОРА)) {
 1547          		СТАРТ ПРОЦ КонтрольСпонтанногоВыключенияВентилятора;
 1548          		В СОСТ ПередачаСообщения;
 1549          	}
 1550            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ВЕНТИЛЯТОРА В СОСТ Ошибка;
 1551            }
 1552           СОСТ ПередачаСообщения {
 1553              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ВЕНТИЛЯТОР_ВКЛЮЧЕН)) СТОП;
 1554              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1555           }
 1556            
 1557          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1558           СОСТ Ошибка {
 1559                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_ВЕНТИЛЯТОРА))	ОШИБКА;
 1560                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1561           }
 1562            СОСТ НарушениеСвязи {
 1563          	   ОШИБКА;
 1564           }   
 1565          } /*конец процесса ВКЛ_ПИТ_ВЕНТИЛЯТОР  */
 1566          
 1567          /*=======================================================*/
 1568          /*=====   Процесс отключения питания вентилятора    =====*/
 1569          /*=======================================================*/
 1570          ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР{
 1571           ИЗ ПРОЦ Инициализация 	К_ПИТ_ВЕНТИЛЯТОРА,
 1572          						У_ПИТ_ВЕНТИЛЯТОРА,
 1573          						Д_ПИТ_ВЕНТИЛЯТОРА
 1574          					/*	ОШИБКА_ФУНКЦ_ВЕНТИЛЯТОР  */
 1575          						;
 1576           СОСТ Начало{
 1577          	ЕСЛИ (ПРОЦ ВКЛ_ПИТ_ВЕНТИЛЯТОР В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВКЛ_ПИТ_ВЕНТИЛЯТОР;
 1578          	СТОП ПРОЦ КонтрольСпонтанногоВыключенияВентилятора;
 1579          /*	ОШИБКА_ФУНКЦ_ВЕНТИЛЯТОР = НЕТ; */
 1580          	У_ПИТ_ВЕНТИЛЯТОРА = ВЫК;
 1581          	В СЛЕДУЮЩЕЕ;      
 1582           }
 1583           
 1584           СОСТ КонтрольВыключения{
 1585          	ЕСЛИ ((К_ПИТ_ВЕНТИЛЯТОРА == ВЫК) && (Д_ПИТ_ВЕНТИЛЯТОРА)) {
 1586          		СТАРТ ПРОЦ КонтрольСпонтанногоВключенияВентилятора;
 1587          		В СОСТ ПередачаСообщения;
 1588          	} 
 1589            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ВЕНТИЛЯТОРА В СОСТ Ошибка;
 1590           }
 1591             
 1592           СОСТ ПередачаСообщения {
 1593              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ВЕНТИЛЯТОР_ВЫКЛЮЧЕН)) СТОП;
 1594              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1595           }
 1596            
 1597          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1598           СОСТ Ошибка {
 1599                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_ВЕНТИЛЯТОРА))	ОШИБКА;
 1600                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1601           }
 1602            СОСТ НарушениеСвязи {
 1603          	   ОШИБКА;
 1604           }   
 1605          } /*конец процесса ВЫК_ПИТ_ВЕНТИЛЯТОРА  */					  
 1606          
 1607          /*========================================================*/
 1608          /*=====   Процесс контроля включенности вентилятора  =====*/
 1609          /*========================================================*/
 1610          ПРОЦ КонтрольСпонтанногоВыключенияВентилятора{
 1611          	ИЗ ПРОЦ Инициализация 	К_ПИТ_ВЕНТИЛЯТОРА;
 1612          
 1613          	СОСТ Контроль {
 1614          		ЕСЛИ (К_ПИТ_ВЕНТИЛЯТОРА == ВЫК) В СОСТ Ошибка;
 1615          	}
 1616          	СОСТ Ошибка {
 1617          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_ВЕНТИЛЯТОРА)) {
 1618          			СТАРТ ПРОЦ ВЫК_ВАКУУМИРОВАНИЕ_ТРУБЫ;  		/* прекращаем вакуумирование */
 1619          			ОШИБКА;}
 1620          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1621          	}
 1622          	
 1623              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 1624          	СОСТ НарушениеСвязи {
 1625          		ОШИБКА;
 1626          	}
 1627          }	
 1628          /*=========================================================*/
 1629          /*=====   Процесс контроля выключенности вентилятора  =====*/
 1630          /*=========================================================*/
 1631          ПРОЦ КонтрольСпонтанногоВключенияВентилятора{
 1632          	ИЗ ПРОЦ Инициализация 	К_ПИТ_ВЕНТИЛЯТОРА;
 1633          	
 1634          	СОСТ Контроль {
 1635          		ЕСЛИ (К_ПИТ_ВЕНТИЛЯТОРА == ВКЛ) В СОСТ Ошибка;
 1636          	}
 1637          	
 1638          	СОСТ Ошибка {
 1639          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_ВЕНТИЛЯТОРА)) ОШИБКА;
 1640          				/*  если включился, то и ладно, вакуумирования-то нет !!!!!!!!!!!!!!!!!*/
 1641          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1642          	}
 1643          
 1644          	
 1645              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 1646          	СОСТ НарушениеСвязи {
 1647          		ОШИБКА;
 1648          	}
 1649          }			  
 1650          /*=========================================================*/
 1651          
 1652          
 1653          /*===========================================================*/
 1654          /*=====   Процесс открытия затвора вакуумного         =======*/
 1655          /*===========================================================*/
 1656          ПРОЦ ОТКР_ЗАТВОР_ВАК{
 1657           ИЗ ПРОЦ Инициализация 	К_ОТКР_ЗАТВОР_ВАК,
 1658          						К_ЗАКР_ЗАТВОР_ВАК,
 1659          						У_ЗАТВОР_ВАК
 1660          					/*	ОШИБКА_ФУНКЦ_ЗАТВОР_ВАК*/
 1661          						;
 1662           СОСТ Начало{
 1663          	ЕСЛИ (ПРОЦ ЗАКР_ЗАТВОР_ВАК В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ЗАКР_ЗАТВОР_ВАК;
 1664          	СТОП ПРОЦ КонтрольСпонтанногоОткрытияЗатвораВакуумного;
 1665          /*	ОШИБКА_ФУНКЦ_ЗАТВОР_ВАК = НЕТ;*/
 1666          	У_ЗАТВОР_ВАК = ОТКР;
 1667          	В СЛЕДУЮЩЕЕ;      
 1668           }
 1669          
 1670           СОСТ Контроль{  
 1671          	ЕСЛИ ((К_ОТКР_ЗАТВОР_ВАК == ВКЛ) && (К_ЗАКР_ЗАТВОР_ВАК = ВЫК)) {
 1672          		СТАРТ ПРОЦ КонтрольСпонтанногоЗакрытияЗатвораВакуумного;		
 1673          		В СОСТ ПередачаСообщения;  
 1674          	}
 1675            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ЗАТ_ВАК В СОСТ Ошибка;
 1676           }
 1677           СОСТ ПередачаСообщения {
 1678              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЗАТВОР_ВАКУУМНЫЙ_ОТКРЫТ)) СТОП;
 1679              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1680           }
 1681           /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1682           СОСТ Ошибка {
 1683                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ОТКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО))	ОШИБКА;
 1684                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1685           }
 1686            СОСТ НарушениеСвязи {
 1687          	   ОШИБКА;
 1688           }
 1689          }   /*конец процесса ОТКР_ЗАТВОР_ВАК */
 1690          /*===========================================================*/
 1691          /*=====   Процесс закрытия затвора вакуумного         =======*/
 1692          /*===========================================================*/
 1693          ПРОЦ ЗАКР_ЗАТВОР_ВАК{
 1694           ИЗ ПРОЦ Инициализация 	К_ОТКР_ЗАТВОР_ВАК,
 1695          						К_ЗАКР_ЗАТВОР_ВАК,
 1696          						У_ЗАТВОР_ВАК  
 1697          					/*	,ОШИБКА_ФУНКЦ_ЗАТВОР_ВАК  */
 1698          						;
 1699          
 1700           СОСТ Начало{
 1701          	ЕСЛИ (ПРОЦ ОТКР_ЗАТВОР_ВАК В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ОТКР_ЗАТВОР_ВАК;
 1702          	СТОП ПРОЦ КонтрольСпонтанногоЗакрытияЗатвораВакуумного;
 1703          /*	ОШИБКА_ФУНКЦ_ЗАТВОР_ВАК = НЕТ; */
 1704          	У_ЗАТВОР_ВАК = ЗАКР;
 1705          	В СЛЕДУЮЩЕЕ;      
 1706           }
 1707           СОСТ Контроль{  
 1708          	ЕСЛИ ((К_ОТКР_ЗАТВОР_ВАК == ВЫК) && (К_ЗАКР_ЗАТВОР_ВАК = ВКЛ)) {
 1709          	СТАРТ ПРОЦ КонтрольСпонтанногоОткрытияЗатвораВакуумного;	
 1710          	В СОСТ ПередачаСообщения;
 1711          	} 
 1712          	ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ЗАТ_ВАК В СОСТ Ошибка;
 1713            }
 1714           СОСТ ПередачаСообщения {
 1715              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ЗАТВОР_ВАКУУМНЫЙ_ЗАКРЫТ)) СТОП;
 1716              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1717           }  
 1718          
 1719           /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1720           СОСТ Ошибка {
 1721              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ЗАКРЫТИЯ_ЗАТВОРА_ВАКУУМНОГО))	ОШИБКА;
 1722              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1723           }
 1724            СОСТ НарушениеСвязи {
 1725          	   ОШИБКА;
 1726           }
 1727          } /*конец процесса ЗАКР_ЗАТВОР_ВАК */
 1728          
 1729          
 1730          /*========================================================*/
 1731          /*=====  Процесс контроля включенности затвора вак.  =====*/
 1732          /*========================================================*/
 1733          /*  затвор был открыт, но вдруг закрылся */
 1734          ПРОЦ КонтрольСпонтанногоЗакрытияЗатвораВакуумного{
 1735          	ИЗ ПРОЦ Инициализация 	К_ОТКР_ЗАТВОР_ВАК,
 1736          							К_ЗАКР_ЗАТВОР_ВАК;
 1737          
 1738          	СОСТ КонтрольЗакрытия {
 1739          		ЕСЛИ ((К_ОТКР_ЗАТВОР_ВАК == ВЫК) && (К_ЗАКР_ЗАТВОР_ВАК = ВКЛ)) В СОСТ Ошибка;
 1740          	}
 1741          	СОСТ Ошибка {
 1742          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ЗАКРЫТИЕ_ЗАТ_ВАКУУМНОГО)) {
 1743          			СТАРТ ПРОЦ ВЫК_ВАКУУМИРОВАНИЕ_ТРУБЫ;  		/* прекращаем вакуумирование */
 1744          			ОШИБКА; }
 1745          		/*  здесь надо выключать вакуумирование !!!!!!!!!!!!!????*/
 1746          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1747          	}
 1748          	
 1749              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 1750          	СОСТ НарушениеСвязи {
 1751          		ОШИБКА;
 1752          	}
 1753          }	
 1754          /*=========================================================*/
 1755          /*=====   Процесс контроля выключенности затвора вак  =====*/
 1756          /*=========================================================*/
 1757          /*  затвор был закрыт, но вдруг открылся */
 1758          ПРОЦ КонтрольСпонтанногоОткрытияЗатвораВакуумного{
 1759          	ИЗ ПРОЦ Инициализация 	К_ОТКР_ЗАТВОР_ВАК,
 1760          							К_ЗАКР_ЗАТВОР_ВАК;
 1761          	
 1762          	СОСТ Контроль {
 1763          		ЕСЛИ ((К_ОТКР_ЗАТВОР_ВАК == ВКЛ) && (К_ЗАКР_ЗАТВОР_ВАК = ВЫК)) В СОСТ Ошибка;
 1764          	}
 1765          	
 1766          	СОСТ Ошибка {
 1767          		/*  если открылся, то вроде бы его надо попытаться закрыть и прекратить вакуумирование !!!!!!!!!!!!!!!!!*/	
 1768          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ОТКРЫТИЕ_ЗАТ_ВАКУУМНОГО)) { ОШИБКА;}
 1769          
 1770          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1771          	}
 1772              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 1773          	СОСТ НарушениеСвязи {
 1774          		ОШИБКА;
 1775          	}
 1776          }			  
 1777          
 1778          /*===========================================================*/
 1779          /*=====   Процесс открытия сапуна                    =======*/
 1780          /*===========================================================*/
 1781          ПРОЦ ОТКР_САПУН{
 1782           ИЗ ПРОЦ Инициализация 	К_САПУН, 
 1783          						У_САПУН
 1784          					/*	ОШИБКА_ФУНКЦ_САПУН */
 1785          						; 	
 1786           СОСТ Начало{
 1787          	ЕСЛИ (ПРОЦ ЗАКР_САПУН В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ЗАКР_САПУН;
 1788          	СТОП ПРОЦ КонтрольСпонтанногоОткрытияСапуна;	
 1789          /*  ЕСЛИ ((К_САПУН == ОТКР) && (ОШИБКА_ФУНКЦ_САПУН == НЕТ)) СТОП;  */ 
 1790          /*	ОШИБКА_ФУНКЦ_САПУН = НЕТ; */
 1791          	У_САПУН = ОТКР;
 1792          	В СЛЕДУЮЩЕЕ;      
 1793           }
 1794          
 1795           СОСТ КонтрольОткрытия{  
 1796          /*  ЕСЛИ ((К_САПУН == ОТКР) && (ОШИБКА_ФУНКЦ_САПУН == НЕТ)) СТОП; */
 1797              ЕСЛИ (К_САПУН == ОТКР) {
 1798          		СТАРТ ПРОЦ КонтрольСпонтанногоЗакрытияСапуна;	
 1799          		В СОСТ ПередачаСообщения;	
 1800          	
 1801          	}В СОСТ ПередачаСообщения;
 1802            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_САПУНА В СОСТ Ошибка;  /* здесь надо выдавать код ошибки в ГУИ */
 1803           }
 1804           СОСТ ПередачаСообщения {
 1805              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_САПУН_ОТКРЫТ)) СТОП;
 1806              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1807           } 
 1808          /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1809           СОСТ Ошибка {
 1810                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ОТКРЫТИЯ_САПУНА))	ОШИБКА;
 1811                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1812           }
 1813            СОСТ НарушениеСвязи {
 1814          	   ОШИБКА;
 1815           }
 1816          }  /*конец процесса ОТКР_САПУН  */
 1817          
 1818          
 1819          
 1820          /*===========================================================*/
 1821          /*==!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! ==========================*/
 1822          /*=====   Процесс закрытия сапуна                    =======*/
 1823          /*===========================================================*/
 1824          ПРОЦ ЗАКР_САПУН{
 1825           ИЗ ПРОЦ Инициализация 	К_САПУН,
 1826                                	У_САПУН
 1827          					/*	ОШИБКА_ФУНКЦ_САПУН */
 1828          						;
 1829          
 1830           СОСТ Начало{
 1831             ЕСЛИ (ПРОЦ ОТКР_САПУН В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ОТКР_САПУН;
 1832          	СТОП ПРОЦ КонтрольСпонтанногоЗакрытияСапуна;   
 1833          /*	ОШИБКА_ФУНКЦ_САПУН = НЕТ;  */
 1834          	У_САПУН = ЗАКР;
 1835          	В СЛЕДУЮЩЕЕ;      
 1836           }
 1837          
 1838           СОСТ КонтрольЗакрытия{  
 1839          	ЕСЛИ (К_САПУН == ЗАКР) {
 1840          		СТАРТ ПРОЦ КонтрольСпонтанногоОткрытияСапуна;	
 1841          		В СОСТ ПередачаСообщения; 
 1842          	}
 1843            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_САПУНА {
 1844            /*      ОШИБКА_ФУНКЦИОНИРОВАНИЯ = ВКЛ;  ??????? */
 1845          	В СОСТ Ошибка;
 1846            }
 1847           }
 1848           СОСТ ПередачаСообщения {
 1849              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_САПУН_ЗАКРЫТ)) СТОП;
 1850              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1851           } 
 1852           /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1853           СОСТ Ошибка {
 1854                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ЗАКРЫТИЯ_САПУНА))	ОШИБКА;
 1855                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1856           }
 1857            СОСТ НарушениеСвязи {
 1858          	   ОШИБКА;
 1859           }
 1860          } /*конец процесса ЗАКР_САПУН  */
 1861          /*========================================================*/
 1862          /*=====  Процесс контроля включенности сапуна        =====*/
 1863          /*========================================================*/
 1864          ПРОЦ КонтрольСпонтанногоЗакрытияСапуна{
 1865          	ИЗ ПРОЦ Инициализация 	К_САПУН;
 1866          
 1867          	СОСТ КонтрольЗакрытия {
 1868          		ЕСЛИ (К_САПУН == ВЫК)  В СОСТ Ошибка;
 1869          	}
 1870          	СОСТ Ошибка {
 1871          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ЗАКРЫТИЕ_САПУНА)) ОШИБКА;
 1872          		/*  здесь надо выключать вакуумирование !!!!!!!!!!!!!????*/
 1873          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1874          	}
 1875          	
 1876              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 1877          	СОСТ НарушениеСвязи {
 1878          		ОШИБКА;
 1879          	}
 1880          }	
 1881          /*=========================================================*/
 1882          /*=====   Процесс контроля выключенности сапуна       =====*/
 1883          /*=========================================================*/
 1884          ПРОЦ КонтрольСпонтанногоОткрытияСапуна{
 1885          	ИЗ ПРОЦ Инициализация 	К_САПУН;
 1886          	
 1887          	СОСТ Контроль {
 1888          		ЕСЛИ (К_САПУН == ВКЛ) В СОСТ Ошибка;
 1889          	}
 1890          	
 1891          	СОСТ Ошибка {
 1892          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ОТКРЫТИЕ_САПУНА)) ОШИБКА;
 1893          				/*  если включился, то и ладно, вакуумирования-то нет !!!!!!!!!!!!!!!!!*/
 1894          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1895          	}
 1896              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 1897          	СОСТ НарушениеСвязи {
 1898          		ОШИБКА;
 1899          	}
 1900          }			  
 1901          
 1902          /*================================================================*/
 1903          /*              Процесс включить питание вакуумного насоса        */
 1904          /*================================================================*/
 1905          ПРОЦ ВКЛ_ПИТ_ВАК_НАСОСА{
 1906           ИЗ ПРОЦ Инициализация 	К_ПИТ_ВАК_НАСОСА,
 1907          						У_ПИТ_ВАК_НАСОСА
 1908          					/*	ОШИБКА_ФУНКЦ_ПИТ_ВАК_НАСОСА */
 1909          						;
 1910          СОСТ Начало{
 1911          	ЕСЛИ (ПРОЦ ВЫК_ПИТ_ВАК_НАСОСА В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВЫК_ПИТ_ВАК_НАСОСА;
 1912          	СТОП ПРОЦ КонтрольСпонтанногоВключенияВакНасоса;
 1913          /*	ОШИБКА_ФУНКЦ_ПИТ_ВАК_НАСОСА = НЕТ;  */
 1914          	У_ПИТ_ВАК_НАСОСА = ВКЛ;
 1915          	В СЛЕДУЮЩЕЕ;      
 1916           }
 1917           СОСТ КонтрольВключения{  
 1918            ЕСЛИ (К_ПИТ_ВАК_НАСОСА == ВКЛ) {
 1919          		СТАРТ ПРОЦ КонтрольСпонтанногоВыключенияВакНасоса;
 1920          		В СОСТ ПередачаСообщения;
 1921            }
 1922            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ВАК_НАСОСА 	В СОСТ Ошибка;
 1923           } 
 1924            СОСТ ПередачаСообщения {
 1925              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_ВАКУУМНОГО_НАСОСА_ВКЛЮЧЕНО)) СТОП;
 1926              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1927           } 
 1928           
 1929                /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1930           СОСТ Ошибка {
 1931                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_ПИТАНИЯ_ВАКУУМНОГО_НАСОСА))	ОШИБКА;
 1932                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1933           }
 1934            СОСТ НарушениеСвязи {
 1935          	   ОШИБКА;
 1936           } 
 1937          } /*конец процесса ВКЛ_ПИТ_ВАК_НАСОСА  */
 1938          /*================================================================*/
 1939          /*              Процесс выключить питание вакуумного насоса       */
 1940          /*================================================================*/
 1941          ПРОЦ ВЫК_ПИТ_ВАК_НАСОСА{
 1942           ИЗ ПРОЦ Инициализация 	К_ПИТ_ВАК_НАСОСА,
 1943          						У_ПИТ_ВАК_НАСОСА
 1944          					/*	ОШИБКА_ФУНКЦ_ПИТ_ВАК_НАСОСА */
 1945          						;
 1946           СОСТ Начало{
 1947          	ЕСЛИ (ПРОЦ ВКЛ_ПИТ_ВАК_НАСОСА В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВКЛ_ПИТ_ВАК_НАСОСА;
 1948          	СТОП ПРОЦ КонтрольСпонтанногоВыключенияВакНасоса;
 1949          /*	ОШИБКА_ФУНКЦ_ПИТ_ВАК_НАСОСА = НЕТ; */
 1950          	У_ПИТ_ВАК_НАСОСА = ВЫК;
 1951          	В СЛЕДУЮЩЕЕ;      
 1952           }
 1953           СОСТ КонтрольВыключения{  
 1954            ЕСЛИ (К_ПИТ_ВАК_НАСОСА == ВЫК) {
 1955            		СТАРТ ПРОЦ КонтрольСпонтанногоВключенияВакНасоса;
 1956          		В СОСТ ПередачаСообщения;
 1957            }
 1958            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_ВАК_НАСОСА 	В СОСТ Ошибка;
 1959           } 
 1960                 /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 1961           СОСТ Ошибка {
 1962                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_ПИТАНИЯ_ВАКУУМНОГО_НАСОСА))	ОШИБКА;
 1963                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1964           }
 1965            СОСТ НарушениеСвязи {
 1966          	   ОШИБКА;
 1967           }
 1968            СОСТ ПередачаСообщения {
 1969              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_ВАКУУМНОГО_НАСОСА_ВЫКЛЮЧЕНО)) СТОП;
 1970              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1971           } 
 1972          }  /*конец процесса ВЫК_ПИТ_ВАК_НАСОСА */
 1973          /*========================================================*/
 1974          /*=====   Процесс контроля спонтанного выключения  =====*/
 1975          /*========================================================*/
 1976          ПРОЦ КонтрольСпонтанногоВыключенияВакНасоса{
 1977          	ИЗ ПРОЦ Инициализация 	К_ПИТ_ВАК_НАСОСА;
 1978          
 1979          	СОСТ Контроль {
 1980          		ЕСЛИ (К_ПИТ_ВАК_НАСОСА == ВЫК) В СОСТ Ошибка;
 1981          	}
 1982          	СОСТ Ошибка {
 1983          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_ВАКУУМНОГО_НАСОСА)) ОШИБКА;
 1984          		/*  здесь надо выключать вакуумирование !!!!!!!!!!!!!!!!!*/
 1985          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 1986          	}
 1987          	
 1988              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 1989          	СОСТ НарушениеСвязи {
 1990          		ОШИБКА;
 1991          	}
 1992          }	
 1993          /*=========================================================*/
 1994          /*=====   Процесс контроля спонтанного включения  =====*/
 1995          /*=========================================================*/
 1996          ПРОЦ КонтрольСпонтанногоВключенияВакНасоса{
 1997          	ИЗ ПРОЦ Инициализация 	К_ПИТ_ВАК_НАСОСА;
 1998          	
 1999          	СОСТ Контроль {
 2000          		ЕСЛИ (К_ПИТ_ВАК_НАСОСА == ВКЛ) В СОСТ Ошибка;
 2001          	}
 2002          	СОСТ Ошибка {
 2003          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_ВАКУУМНОГО_НАСОСА)) ОШИБКА;
 2004          				/*  если включился, то и ладно, вакуумирования-то нет !!!!!!!!!!!!!!!!!*/
 2005          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2006          	}
 2007              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 2008          	СОСТ НарушениеСвязи {
 2009          		ОШИБКА;
 2010          	}
 2011          }			  
 2012          
 2013          /*================================================================*/
 2014          /*              Процесс Подать питание на регулятор температуры   */
 2015          /*================================================================*/
 2016          ПРОЦ ВКЛ_ПИТ_РЕГ_Т{
 2017           ИЗ ПРОЦ Инициализация 	У_ПИТ_РЕГ_Т,					
 2018          						К_ПИТ_РЕГ_Т
 2019          					/*	ОШИБКА_ФУНКЦ_ПИТ_РЕГ_Т */
 2020          						;
 2021           
 2022           
 2023           СОСТ Начало{
 2024          	ЕСЛИ (ПРОЦ ВЫК_ПИТ_РЕГ_Т В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВЫК_ПИТ_РЕГ_Т;
 2025          		СТОП ПРОЦ КонтрольСпонтанногоВключенияРЕГ_Т;
 2026          /*		ОШИБКА_ФУНКЦ_ПИТ_РЕГ_Т = НЕТ; */
 2027          		У_ПИТ_РЕГ_Т = ВКЛ;
 2028          		В СЛЕДУЮЩЕЕ;      
 2029           }
 2030          
 2031           СОСТ КонтрольВключения{  
 2032          	ЕСЛИ (К_ПИТ_РЕГ_Т == ВКЛ) {
 2033          		СТАРТ ПРОЦ КонтрольСпонтанногоВыключенияРЕГ_Т;
 2034          		В СОСТ ПередачаСообщения;
 2035          	}
 2036          	ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_РЕГ_Т В СОСТ Ошибка;
 2037           } 
 2038             СОСТ ПередачаСообщения {
 2039              ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ_ВКЛЮЧЕНО)) СТОП;
 2040              ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2041           } 
 2042                 /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2043           СОСТ Ошибка {
 2044                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ))	ОШИБКА;
 2045                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2046           }
 2047            СОСТ НарушениеСвязи {
 2048          	   ОШИБКА;
 2049           } 
 2050          } /*конец процесса ВКЛ_ПИТ_РЕГ_Т */
 2051          
 2052          /*================================================================*/
 2053          /*        Процесс Снять питание с регулятора температуры          */
 2054          /*================================================================*/
 2055          ПРОЦ ВЫК_ПИТ_РЕГ_Т{
 2056           ИЗ ПРОЦ Инициализация 	У_ПИТ_РЕГ_Т,
 2057          						К_ПИТ_РЕГ_Т
 2058          					/*	ОШИБКА_ФУНКЦ_ПИТ_РЕГ_Т */
 2059          						;
 2060           
 2061           
 2062           СОСТ Начало{
 2063          	ЕСЛИ (ПРОЦ ВКЛ_ПИТ_РЕГ_Т В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВКЛ_ПИТ_РЕГ_Т;
 2064          	СТОП ПРОЦ КонтрольСпонтанногоВыключенияРЕГ_Т;
 2065          /*	ОШИБКА_ФУНКЦ_ПИТ_РЕГ_Т = НЕТ; */
 2066          	У_ПИТ_РЕГ_Т  = ВЫК;
 2067          	В СЛЕДУЮЩЕЕ;      
 2068           }
 2069           СОСТ КонтрольВыключения{  
 2070          	ЕСЛИ (К_ПИТ_РЕГ_Т == ВКЛ) {
 2071          		СТАРТ ПРОЦ КонтрольСпонтанногоВключенияРЕГ_Т;  
 2072          		В СОСТ ПередачаСообщения;
 2073          	} 
 2074          	ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_РЕГ_Т В СОСТ Ошибка;
 2075           }
 2076            СОСТ ПередачаСообщения {
 2077          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ_ВЫКЛЮЧЕНО)) СТОП;
 2078          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2079           }  
 2080                  /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2081           СОСТ Ошибка {
 2082                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ))	ОШИБКА;
 2083                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2084           }
 2085            СОСТ НарушениеСвязи {
 2086          	   ОШИБКА;
 2087           } 
 2088          }  /*конец процесса ВЫК_ПИТ_РЕГ_Т */
 2089          
 2090          /*========================================================*/
 2091          /*=====   Процесс контроля спонтанного выключения  =====*/
 2092          /*========================================================*/
 2093          ПРОЦ КонтрольСпонтанногоВыключенияРЕГ_Т{
 2094          	ИЗ ПРОЦ Инициализация 	К_ПИТ_РЕГ_Т;
 2095          
 2096          	СОСТ Контроль {
 2097          		ЕСЛИ (К_ПИТ_РЕГ_Т == ВЫК) В СОСТ Ошибка;
 2098          	}
 2099          	СОСТ Ошибка {
 2100          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ)) ОШИБКА;
 2101          		/*  здесь надо выключать вакуумирование !!!!!!!!!!!!!!!!!*/
 2102          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2103          	}
 2104          	
 2105              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 2106          	СОСТ НарушениеСвязи {
 2107          		ОШИБКА;
 2108          	}
 2109          }	
 2110          /*=========================================================*/
 2111          /*=====   Процесс контроля спонтанного включения  =====*/
 2112          /*=========================================================*/
 2113          ПРОЦ КонтрольСпонтанногоВключенияРЕГ_Т{
 2114          	ИЗ ПРОЦ Инициализация 	К_ПИТ_РЕГ_Т;
 2115          	
 2116          	СОСТ Контроль {
 2117          		ЕСЛИ (К_ПИТ_РЕГ_Т == ВКЛ) В СОСТ Ошибка;
 2118          	}
 2119          	СОСТ Ошибка {
 2120          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_РЕГУЛЯТОРА_ТЕМПЕРАТУРЫ)) ОШИБКА;
 2121          				/*  если включился, то и ладно, вакуумирования-то нет !!!!!!!!!!!!!!!!!*/
 2122          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2123          	}
 2124              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 2125          	СОСТ НарушениеСвязи {
 2126          		ОШИБКА;
 2127          	}
 2128          }			  
 2129          
 2130          /*================================================================*/
 2131          /*        Процесс Подать питание на регулятор уровня воды         */
 2132          /*================================================================*/
 2133          ПРОЦ ВКЛ_ПИТ_РЕГ_УР{
 2134           ИЗ ПРОЦ Инициализация 	У_ПИТ_РЕГ_УР,
 2135          						К_ПИТ_РЕГ_УР
 2136          					/*	ОШИБКА_ФУНКЦ_ПИТ_РЕГ_УР */
 2137          						;
 2138          
 2139           СОСТ Начало{
 2140          	ЕСЛИ (ПРОЦ ВЫК_ПИТ_РЕГ_УР В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВЫК_ПИТ_РЕГ_УР;
 2141          	СТОП ПРОЦ КонтрольСпонтанногоВключенияРЕГ_УР;
 2142          /*	ОШИБКА_ФУНКЦ_ПИТ_РЕГ_УР = НЕТ; */
 2143          	У_ПИТ_РЕГ_УР = ВКЛ;
 2144          	В СЛЕДУЮЩЕЕ;      
 2145           }
 2146          
 2147           СОСТ Контроль{  
 2148          	ЕСЛИ (К_ПИТ_РЕГ_УР == ВКЛ){
 2149          		СТАРТ ПРОЦ КонтрольСпонтанногоВыключенияРЕГ_УР;
 2150          		В СОСТ ПередачаСообщения;
 2151          	} 
 2152            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_РЕГ_УР В СОСТ Ошибка; 
 2153            }
 2154           СОСТ ПередачаСообщения {
 2155            ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_УРОВНЯ_ВКЛЮЧЕНО)) СТОП;
 2156            ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2157           }  
 2158            
 2159                   /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2160           СОСТ Ошибка {
 2161                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_РЕГУЛЯТОРА_УРОВНЯ))	ОШИБКА;
 2162                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2163           }
 2164            СОСТ НарушениеСвязи {
 2165          	   ОШИБКА;
 2166           } 
 2167          }  /*конец процесса ВКЛ_ПИТ_РЕГ_УР */
 2168          
 2169          /*================================================================*/
 2170          /*        Процесс Снять питание с регулятора уровня воды          */
 2171          /*================================================================*/
 2172          ПРОЦ ВЫК_ПИТ_РЕГ_УР{
 2173           ИЗ ПРОЦ Инициализация 	У_ПИТ_РЕГ_УР,
 2174          						К_ПИТ_РЕГ_УР
 2175          					/*	ОШИБКА_ФУНКЦ_ПИТ_РЕГ_УР */
 2176          						;
 2177          
 2178           СОСТ Начало{
 2179          	ЕСЛИ (ПРОЦ ВКЛ_ПИТ_РЕГ_УР В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВКЛ_ПИТ_РЕГ_УР;
 2180          	СТОП ПРОЦ КонтрольСпонтанногоВыключенияРЕГ_УР;
 2181          /*	ОШИБКА_ФУНКЦ_ПИТ_РЕГ_УР = НЕТ; */
 2182          	У_ПИТ_РЕГ_УР = ВЫК;
 2183          	В СЛЕДУЮЩЕЕ;      
 2184           }
 2185          
 2186           СОСТ Контроль{  
 2187          	ЕСЛИ (К_ПИТ_РЕГ_УР == ВЫК) {
 2188          		СТАРТ ПРОЦ КонтрольСпонтанногоВключенияРЕГ_УР;  
 2189          		В СОСТ ПередачаСообщения;
 2190          	} 
 2191            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_РЕГ_УР 	В СОСТ Ошибка; 
 2192           }
 2193           СОСТ ПередачаСообщения {
 2194            ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_РЕГУЛЯТОРА_УРОВНЯ_ВЫКЛЮЧЕНО)) СТОП;
 2195            ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2196           }  
 2197           
 2198                    /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2199            СОСТ Ошибка {
 2200                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_РЕГУЛЯТОРА_УРОВНЯ))	ОШИБКА;
 2201                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2202           }
 2203            СОСТ НарушениеСвязи {
 2204          	   ОШИБКА;
 2205           } 
 2206          }  /*конец процесса ВЫК_ПИТ_РЕГ_УР */
 2207          
 2208          /*========================================================*/
 2209          /*=====   Процесс контроля спонтанного выключения  =====*/
 2210          /*========================================================*/
 2211          ПРОЦ КонтрольСпонтанногоВыключенияРЕГ_УР{
 2212          	ИЗ ПРОЦ Инициализация 	К_ПИТ_РЕГ_УР;
 2213          
 2214          	СОСТ Контроль {
 2215          		ЕСЛИ (К_ПИТ_РЕГ_УР == ВЫК) В СОСТ Ошибка;
 2216          	}
 2217          	СОСТ Ошибка {
 2218          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_РЕГУЛЯТОРА_УРОВНЯ)) ОШИБКА;
 2219          		/*  здесь надо выключать вакуумирование !!!!!!!!!!!!!!!!!*/
 2220          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2221          	}
 2222          	
 2223              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 2224          	СОСТ НарушениеСвязи {
 2225          		ОШИБКА;
 2226          	}
 2227          }	
 2228          /*=========================================================*/
 2229          /*=====   Процесс контроля спонтанного включения  =====*/
 2230          /*=========================================================*/
 2231          ПРОЦ КонтрольСпонтанногоВключенияРЕГ_УР{
 2232          	ИЗ ПРОЦ Инициализация 	К_ПИТ_РЕГ_УР;
 2233          	
 2234          	СОСТ Контроль {
 2235          		ЕСЛИ (К_ПИТ_РЕГ_УР == ВКЛ) В СОСТ Ошибка;
 2236          	}
 2237          	СОСТ Ошибка {
 2238          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_РЕГУЛЯТОРА_УРОВНЯ)) ОШИБКА;
 2239          				/*  если включился, то и ладно, вакуумирования-то нет !!!!!!!!!!!!!!!!!*/
 2240          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2241          	}
 2242              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 2243          	СОСТ НарушениеСвязи {
 2244          		ОШИБКА;
 2245          	}
 2246          }	
 2247          
 2248          /*================================================================*/
 2249          /*              Процесс Подать питание на насос охлаждения        */
 2250          /*================================================================*/
 2251          ПРОЦ ВКЛ_ПИТ_НАС_ОХЛ{
 2252           ИЗ ПРОЦ Инициализация 	У_ПИТ_НАС_ОХЛ,
 2253          						К_ПИТ_НАСОС_ОХЛ,
 2254          						ФлагГотовУрВодыБО,
 2255          						ФлагГотовТемпВодыБО
 2256          					/*	ОШИБКА_ФУНКЦ_НАСОС_ОХЛ */
 2257          						;
 2258          						
 2259           СОСТ Начало{
 2260            ЕСЛИ (ФлагГотовУрВодыБО == НОРМА)  В СЛЕДУЮЩЕЕ;
 2261            ИНАЧЕ ОШИБКА;      
 2262           }
 2263          
 2264           СОСТ ВключениеПитания{
 2265          	ЕСЛИ (ПРОЦ ВЫК_ПИТ_НАС_ОХЛ В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВЫК_ПИТ_НАС_ОХЛ;
 2266          	СТОП ПРОЦ КонтрольСпонтанногоВключенияНасосаОхлаждения;   
 2267          /*	ОШИБКА_ФУНКЦ_НАСОС_ОХЛ = НЕТ; */
 2268          	У_ПИТ_НАС_ОХЛ = ВКЛ;
 2269          	В СЛЕДУЮЩЕЕ;      
 2270           }
 2271          
 2272           СОСТ Контроль{  
 2273            ЕСЛИ (К_ПИТ_НАСОС_ОХЛ == ВКЛ) {
 2274            	СТАРТ ПРОЦ КонтрольСпонтанногоВыключенияНасосаОхлаждения;
 2275          	В СОСТ ПередачаСообщения;
 2276            } 
 2277            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_НАСОС_ОХЛ В СОСТ Ошибка;
 2278           }    
 2279           СОСТ ПередачаСообщения {
 2280            ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_НАСОСА_ОХЛАЖДЕНИЯ_ВКЛЮЧЕНО)) СТОП;
 2281            ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2282           }   
 2283          
 2284                     /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2285            СОСТ Ошибка {
 2286                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_НАСОСА_ОХЛАЖДЕНИЯ))	ОШИБКА;
 2287                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2288           }
 2289            СОСТ НарушениеСвязи {
 2290          	   ОШИБКА;
 2291           } 
 2292          } /*конец процесса ВКЛ_ПИТ_НАС_ОХЛАЖДЕНИЯ */
 2293          
 2294          /*================================================================*/
 2295          /*             Процесс Снять питание с насоса охлаждения          */
 2296          /*================================================================*/
 2297          ПРОЦ ВЫК_ПИТ_НАС_ОХЛ{
 2298           ИЗ ПРОЦ Инициализация 	У_ПИТ_НАС_ОХЛ,
 2299          						К_ПИТ_НАСОС_ОХЛ
 2300          					/*	ОШИБКА_ФУНКЦ_НАСОС_ОХЛ */
 2301          						;
 2302          
 2303           СОСТ Начало{
 2304          	ЕСЛИ (ПРОЦ ВКЛ_ПИТ_НАС_ОХЛ В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВКЛ_ПИТ_НАС_ОХЛ;
 2305             	СТОП ПРОЦ КонтрольСпонтанногоВыключенияНасосаОхлаждения;
 2306          /*	ОШИБКА_ФУНКЦ_НАСОС_ОХЛ = НЕТ; */
 2307          	У_ПИТ_НАС_ОХЛ = ВЫК;
 2308          	В СЛЕДУЮЩЕЕ;      
 2309           }
 2310          
 2311           СОСТ Контроль{  
 2312            ЕСЛИ (К_ПИТ_НАСОС_ОХЛ == ВЫК) {
 2313            		СТАРТ ПРОЦ КонтрольСпонтанногоВключенияНасосаОхлаждения;
 2314          		В СОСТ ПередачаСообщения;
 2315            }
 2316            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_НАСОС_ОХЛ В СОСТ Ошибка; 
 2317           }
 2318           СОСТ ПередачаСообщения {
 2319            ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ПИТАНИЕ_НАСОСА_ОХЛАЖДЕНИЯ_ВЫКЛЮЧЕНО)) СТОП;
 2320            ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2321           }  
 2322                      /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2323            СОСТ Ошибка {
 2324                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_НАСОСА_ОХЛАЖДЕНИЯ))	ОШИБКА;
 2325                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2326           }
 2327            СОСТ НарушениеСвязи {
 2328          	   ОШИБКА;
 2329           } 
 2330          } /*конец процесса ВЫК_ПИТ_НАС_ОХЛАЖДЕНИЯ */
 2331          
 2332          /*========================================================*/
 2333          /*=====   Процесс контроля спонтанного выключения  =====*/
 2334          /*========================================================*/
 2335          ПРОЦ КонтрольСпонтанногоВыключенияНасосаОхлаждения{
 2336          	ИЗ ПРОЦ Инициализация 	К_ПИТ_НАСОС_ОХЛ;
 2337          
 2338          	СОСТ Контроль {
 2339          		ЕСЛИ (К_ПИТ_НАСОС_ОХЛ == ВЫК) В СОСТ Ошибка;
 2340          	}
 2341          	СОСТ Ошибка {
 2342          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_НАСОСА_ОХЛАЖДЕНИЯ)) ОШИБКА;
 2343          		/*  здесь надо выключать вакуумирование !!!!!!!!!!!!!!!!!*/
 2344          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2345          	}
 2346          	
 2347              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 2348          	СОСТ НарушениеСвязи {
 2349          		ОШИБКА;
 2350          	}
 2351          }	
 2352          /*=========================================================*/
 2353          /*=====   Процесс контроля спонтанного включения  =====*/
 2354          /*=========================================================*/
 2355          ПРОЦ КонтрольСпонтанногоВключенияНасосаОхлаждения{
 2356          	ИЗ ПРОЦ Инициализация 	К_ПИТ_НАСОС_ОХЛ;
 2357          	
 2358          	СОСТ Контроль {
 2359          		ЕСЛИ (К_ПИТ_НАСОС_ОХЛ == ВКЛ) В СОСТ Ошибка;
 2360          	}
 2361          	СОСТ Ошибка {
 2362          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_НАСОСА_ОХЛАЖДЕНИЯ)) ОШИБКА;
 2363          				/*  если включился, то и ладно, вакуумирования-то нет !!!!!!!!!!!!!!!!!*/
 2364          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2365          	}
 2366              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 2367          	СОСТ НарушениеСвязи {
 2368          		ОШИБКА;
 2369          	}
 2370          }	
 2371          
 2372          
 2373          /*=========================================================++++++++++++======*/
 2374          /*==   Процесс  ВКЛЮЧИТЬ Устройство плавного пуска (запуск вакуумирования)   */
 2375          /*== это означает что вакуумного насос начнет работать          			 */
 2376          /*==========================================================++++++++++++=====*/
 2377          
 2378          ПРОЦ ВКЛ_УСТР_ПЛАВ_ПУСКА{
 2379           ИЗ ПРОЦ Инициализация 	К_УСТР_ПЛАВ_ПУСКА,
 2380          						У_УСТР_ПЛАВ_ПУСКА
 2381          					/*	ОШИБКА_ФУНКЦ_УСТР_ПЛАВ_ПУСКА */
 2382          						;
 2383          						
 2384          
 2385           СОСТ Начало{
 2386          	ЕСЛИ (ПРОЦ ВЫК_УСТР_ПЛАВ_ПУСКА В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВЫК_УСТР_ПЛАВ_ПУСКА;
 2387              СТОП ПРОЦ КонтрольСпонтанногоВключенияПлавнПуска;
 2388          /*	ОШИБКА_ФУНКЦ_УСТР_ПЛАВ_ПУСКА = НЕТ;  */
 2389          	У_УСТР_ПЛАВ_ПУСКА = ВКЛ;
 2390          	В СЛЕДУЮЩЕЕ;      
 2391           }
 2392          
 2393           СОСТ Контроль{  
 2394          	ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВКЛ) {
 2395          		СТАРТ ПРОЦ КонтрольСпонтанногоВыключенияПлавнПуска;  
 2396          		В СОСТ ПередачаСообщения;
 2397          	}
 2398            ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_УСТР_ПЛАВ_ПУСКА  	В СОСТ Ошибка;
 2399           } 
 2400           СОСТ ПередачаСообщения {
 2401            ЕСЛИ (SendMsgGUICode(ПК_ГУИ_УСТРОЙСТВО_ПЛАВНОГО_ПУСКА_ВКЛЮЧЕНО)) СТОП;
 2402            ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2403           }  
 2404               /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2405           СОСТ Ошибка {
 2406                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_УСТР_ПЛАВ_ПУСКА))	ОШИБКА;
 2407                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2408           }
 2409            СОСТ НарушениеСвязи {
 2410          	   ОШИБКА;
 2411           } 
 2412          }  /*конец процесса ВКЛ_УСТР_ПЛАВ_ПУСКА  */
 2413          
 2414          /*===============================================================*/
 2415          /*==   Процесс  ВЫКЛЮЧИТЬ Устройство плавного пуска                  */
 2416          /*===============================================================*/
 2417          ПРОЦ ВЫК_УСТР_ПЛАВ_ПУСКА{
 2418           ИЗ ПРОЦ Инициализация 	К_УСТР_ПЛАВ_ПУСКА,
 2419          						У_УСТР_ПЛАВ_ПУСКА
 2420          					/*	ОШИБКА_ФУНКЦ_УСТР_ПЛАВ_ПУСКА */
 2421          						;
 2422          						
 2423           СОСТ Начало{	
 2424          	ЕСЛИ (ПРОЦ ВКЛ_УСТР_ПЛАВ_ПУСКА В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВКЛ_УСТР_ПЛАВ_ПУСКА;
 2425          	СТОП ПРОЦ КонтрольСпонтанногоВыключенияПлавнПуска;	
 2426          /*	ОШИБКА_ФУНКЦ_УСТР_ПЛАВ_ПУСКА = НЕТ; */
 2427          	У_УСТР_ПЛАВ_ПУСКА = ВЫК;	
 2428          	В СЛЕДУЮЩЕЕ;      
 2429           }
 2430           СОСТ КонтрольВыключения{  
 2431          	ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) {
 2432          		СТАРТ ПРОЦ КонтрольСпонтанногоВключенияПлавнПуска;
 2433          		В СОСТ ПередачаСообщения;
 2434          	}
 2435          	ТАЙМАУТ ТАЙМАУТ_НА_СРАБАТЫВАНИЕ_УСТР_ПЛАВ_ПУСКА 	В СОСТ Ошибка;
 2436           }
 2437           СОСТ ПередачаСообщения {
 2438            ЕСЛИ (SendMsgGUICode(ПК_ГУИ_УСТРОЙСТВО_ПЛАВНОГО_ПУСКА_ВЫКЛЮЧЕНО)) СТОП;
 2439            ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи; 
 2440            }
 2441            
 2442                 /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2443            СОСТ Ошибка {
 2444                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_УСТР_ПЛАВ_ПУСКА))	ОШИБКА;
 2445                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2446           }
 2447            СОСТ НарушениеСвязи {
 2448          	   ОШИБКА;
 2449           } 
 2450          } /*конец процесса ВЫК_УСТР_ПЛАВ_ПУСКА  */
 2451          
 2452          /*========================================================*/
 2453          /*=====   Процесс контроля спонтанного выключения  =====*/
 2454          /*========================================================*/
 2455          ПРОЦ КонтрольСпонтанногоВыключенияПлавнПуска{
 2456          	ИЗ ПРОЦ Инициализация 	К_УСТР_ПЛАВ_ПУСКА;
 2457          
 2458          	СОСТ Контроль {
 2459          		ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВЫК) В СОСТ Ошибка;
 2460          	}
 2461          	СОСТ Ошибка {
 2462          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВЫКЛЮЧЕНИЕ_УСТРОЙСТВА_ПЛАВНОГО_ПУСКА)) ОШИБКА;
 2463          		/*  здесь надо выключать вакуумирование !!!!!!!!!!!!!!!!!*/
 2464          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2465          	}
 2466          	
 2467              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/	
 2468          	СОСТ НарушениеСвязи {
 2469          		ОШИБКА;
 2470          	}
 2471          }	
 2472          /*=========================================================*/
 2473          /*=====   Процесс контроля спонтанного включения  =====*/
 2474          /*=========================================================*/
 2475          ПРОЦ КонтрольСпонтанногоВключенияПлавнПуска{
 2476          	ИЗ ПРОЦ Инициализация 	К_УСТР_ПЛАВ_ПУСКА;
 2477          	
 2478          	СОСТ Контроль {
 2479          		ЕСЛИ (К_УСТР_ПЛАВ_ПУСКА == ВКЛ) В СОСТ Ошибка;
 2480          	}
 2481          	СОСТ Ошибка {
 2482          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_СПОНТАННОЕ_ВКЛЮЧЕНИЕ_УСТРОЙСТВА_ПЛАВНОГО_ПУСКА)) ОШИБКА;
 2483          				/*  если включился, то и ладно, вакуумирования-то нет !!!!!!!!!!!!!!!!!*/
 2484          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2485          	}
 2486              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/		
 2487          	СОСТ НарушениеСвязи {
 2488          		ОШИБКА;
 2489          	}
 2490          }	
 2491          
 2492          
 2493          
 2494          
 2495          
 2496          /*======================================================================*/
 2497          /*              Процесс Включить вакуумную подсистему                   */
 2498          /*   Этапы включения вакуумного насоса:                                 */ 
 2499          /*   1. Проверяем допустимое давление в компрессоре. Норма - идем дальше */  
 2500          /*   2. Проверяем температуру и уровень воды в баке охлаждения          */ 
 2501          /*      норма - идем дальше   											*/ 
 2502          /*   3. Включаем питание вентилятора                                    */ 
 2503          /*   4. Включаем питание насоса охлаждения                              */  
 2504          /*   5. Закрываем затвор вакуумный                                      */ 
 2505          /*   6. Открываем сапун                                                 */ 
 2506          /*   7. Контролируем температуру воды в рубашке, если норма             */
 2507          /*                                    - идем дальше                     */ 
 2508          /*   8. Включаем питание вакуумного насоса                              */ 
 2509          /*   9. Включаем устройство плавного пуска                              */ 
 2510          /*   10. Выдерживаем одну минуту и закрываем сапун                      */ 
 2511          /*   11. Если ФП_P_ВтрубеСидер >= ФП_P_Впатрубке - открываем затвор     */
 2512          /*       вакуумный. Пошло вакуумирование. Иначе - даем 2 минуты  		*/
 2513          /*		на откачку из патрубка, и      									*/  
 2514          /*       если откачки нет, то стартуем проц выключения вак. подсистемы  */
 2515          /*       и уходим в ошибку .  											*/
 2516          /*======================================================================*/
 2517          ПРОЦ ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ{
 2518           ИЗ ПРОЦ Инициализация 	У_ПИТ_НАС_ОХЛ,
 2519          						ФП_P_Впатрубке,		
 2520          						ФП_P_ВтрубеСидер,
 2521          						ФлагГотовTВодыРО,
 2522          						ФлагГотовТемпВодыБО,
 2523          						ФП_P_ВбакеКомпрессора,
 2524          						ФП_T_Вбаке,
 2525          						ФлагГотовУрВодыБО,
 2526          						ФлагДавленияКомпрессора;
 2527           ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 2528           
 2529           СОСТ Начало{
 2530          	ЕСЛИ (ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ АКТИВНОЕ) ОШИБКА ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ;
 2531          	/* нельзя включать насос вакуумный, если давление в компрессоре < 5-10 атмосфер*/
 2532          		ЕСЛИ (ФлагДавленияКомпрессора != НОРМА) В СОСТ ВыключениеПоОшибке;
 2533          		ИНАЧЕ В СЛЕДУЮЩЕЕ;
 2534          	}
 2535          	
 2536          	/*м.б. здесь надо подождать, пока температура достигнет нормы?  ????????????*/
 2537          	
 2538          	СОСТ КонтрольГотовностиУровняИтемпературы{
 2539          		ЕСЛИ ((ФП_T_Вбаке > Т_ПредельнаяВбакеОхлаждения)|| 
 2540          			(ФлагГотовУрВодыБО == ВНЕ_НОРМЫ)||
 2541          			(ФлагГотовТемпВодыБО == ВНЕ_НОРМЫ )) В СОСТ ВыключениеПоОшибке;
 2542          			ИНАЧЕ 	{
 2543          				СТАРТ ПРОЦ ВКЛ_ПИТ_ВЕНТИЛЯТОР;
 2544          				В СЛЕДУЮЩЕЕ;
 2545          			}
 2546          	}
 2547          	СОСТ КонтрольВключенияВентилятора{
 2548          		ЕСЛИ ( ПРОЦ ВКЛ_ПИТ_ВЕНТИЛЯТОР В СОСТ ПАССИВНОЕ){ 
 2549          				ЕСЛИ (ПРОЦ  ВКЛ_ПИТ_ВЕНТИЛЯТОР В СОСТ ОШИБКА ) В СОСТ ВыключениеПоОшибке;
 2550          				ИНАЧЕ {
 2551          					СТАРТ ПРОЦ ВКЛ_ПИТ_НАС_ОХЛ;
 2552          					В СЛЕДУЮЩЕЕ;
 2553          				}
 2554          		}
 2555          	}  
 2556          	СОСТ КонтрольВключенияПитанияНасосаОхлаждения{
 2557          		ЕСЛИ (ПРОЦ ВКЛ_ПИТ_НАС_ОХЛ В СОСТ ПАССИВНОЕ){ 
 2558          				ЕСЛИ (ПРОЦ  ВКЛ_ПИТ_НАС_ОХЛ В СОСТ ОШИБКА) В СОСТ ВыключениеПоОшибке;
 2559          				ИНАЧЕ {
 2560          					СТАРТ ПРОЦ ЗАКР_ЗАТВОР_ВАК ;
 2561          					В СЛЕДУЮЩЕЕ;
 2562          				}
 2563          		}
 2564          	}  
 2565          	СОСТ КонтрольЗакрытияЗатвораВакуумного{
 2566          		ЕСЛИ (ПРОЦ ЗАКР_ЗАТВОР_ВАК В СОСТ ПАССИВНОЕ){ 
 2567          			ЕСЛИ (ПРОЦ ЗАКР_ЗАТВОР_ВАК В СОСТ ОШИБКА ) В СОСТ ВыключениеПоОшибке;
 2568          			ИНАЧЕ {
 2569          				СТАРТ ПРОЦ ОТКР_САПУН;
 2570          				В СЛЕДУЮЩЕЕ;
 2571          			}
 2572          		} 
 2573          	} 
 2574          	СОСТ КонтрольОткрытияСапуна{
 2575          		ЕСЛИ ( ПРОЦ ОТКР_САПУН В СОСТ ПАССИВНОЕ){ 
 2576          			ЕСЛИ (ПРОЦ ОТКР_САПУН В СОСТ ОШИБКА ) В СОСТ ВыключениеПоОшибке;
 2577          			ИНАЧЕ В СЛЕДУЮЩЕЕ;
 2578          		} 
 2579          	}
 2580           /*м.б. здесь надо подождать, пока температура достигнет нормы?  ????????????*/ 	
 2581          	СОСТ КонтрольТемпературыРубашки{
 2582          		ЕСЛИ (ФлагГотовTВодыРО == НОРМА) В СЛЕДУЮЩЕЕ;
 2583          /*		ТАЙМАУТ ПЯТЬ_МИНУТ ОШИБКА;  */
 2584          		ИНАЧЕ В СОСТ ВыключениеПоОшибке;
 2585          	}
 2586          	СОСТ ПодачаПитанияНаВакуумныйНасос{
 2587          		СТАРТ ПРОЦ ВКЛ_ПИТ_ВАК_НАСОСА;
 2588          		В СЛЕДУЮЩЕЕ;
 2589          	}	
 2590          	СОСТ КонтрольПитанияВакуумногоНасоса{
 2591          		ЕСЛИ ( ПРОЦ ВКЛ_ПИТ_ВАК_НАСОСА В СОСТ ПАССИВНОЕ){ 
 2592          			ЕСЛИ (ПРОЦ  ВКЛ_ПИТ_ВАК_НАСОСА В СОСТ ОШИБКА) В СОСТ ВыключениеПоОшибке;
 2593          			ИНАЧЕ  В СЛЕДУЮЩЕЕ;
 2594          		} 
 2595          	}  
 2596          	СОСТ ВключениеУстройстваПлавногоПуска{
 2597          		СТАРТ ПРОЦ ВКЛ_УСТР_ПЛАВ_ПУСКА;
 2598          		В СЛЕДУЮЩЕЕ;
 2599          	}
 2600          	СОСТ КонтрольВлюченияПлавногоПуска{
 2601          		ЕСЛИ (ПРОЦ ВКЛ_УСТР_ПЛАВ_ПУСКА В СОСТ ПАССИВНОЕ){ 
 2602          			ЕСЛИ (ПРОЦ  ВКЛ_УСТР_ПЛАВ_ПУСКА В СОСТ ОШИБКА) В СОСТ ВыключениеПоОшибке;
 2603          			ИНАЧЕ  В СЛЕДУЮЩЕЕ;
 2604          		} 
 2605          	}  	
 2606          	СОСТ ТаймаутПередЗакрытиемСапуна{  /*насос должен разогнаться*/
 2607          		ТАЙМАУТ ОДНА_МИНУТА В СЛЕДУЮЩЕЕ; 
 2608          	}  
 2609          	
 2610          	СОСТ ЗакрытиеСапуна{  
 2611          		СТАРТ ПРОЦ ЗАКР_САПУН;
 2612          		В СЛЕДУЮЩЕЕ; 
 2613          	} 
 2614          	СОСТ КонтрольЗакрытияСапуна{
 2615          		ЕСЛИ ( ПРОЦ ЗАКР_САПУН В СОСТ ПАССИВНОЕ){ 
 2616          			ЕСЛИ (ПРОЦ ЗАКР_САПУН В СОСТ ОШИБКА ) В СОСТ ВыключениеПоОшибке;
 2617          			ИНАЧЕ В СЛЕДУЮЩЕЕ;
 2618          		} 
 2619          	} 
 2620          	
 2621          	СОСТ ЗапоминаемДавлениеВпатрубке{
 2622          			ЛП_Предыдущее = ФП_P_Впатрубке;
 2623          			В СЛЕДУЮЩЕЕ;
 2624          	}
 2625          	СОСТ КонтрольДавления{  
 2626          		ЕСЛИ (ФП_P_ВтрубеСидер >= ФП_P_Впатрубке) {
 2627          			СТАРТ ПРОЦ ОТКР_ЗАТВОР_ВАК; 
 2628          			В СОСТ КонтрольОткрытияЗВ;
 2629          			}
 2630          		ИНАЧЕ В СЛЕДУЮЩЕЕ;
 2631          	} 	
 2632          	СОСТ ПаузаНаОткачкуВпатрубке{  
 2633          		ТАЙМАУТ ДВЕ_МИНУТЫ В СЛЕДУЮЩЕЕ; 
 2634          	}  
 2635          	СОСТ ПроверкаУменьшенияДавленияВпатрубке{  
 2636          		ЕСЛИ(ФП_P_Впатрубке < ЛП_Предыдущее) В СОСТ ЗапоминаемДавлениеВпатрубке;
 2637                  ИНАЧЕ В СОСТ Ошибка;
 2638          	} 	
 2639          	СОСТ КонтрольОткрытияЗВ{
 2640          		ЕСЛИ ( ПРОЦ ОТКР_ЗАТВОР_ВАК В СОСТ ПАССИВНОЕ){ 
 2641          			ЕСЛИ (ПРОЦ ОТКР_ЗАТВОР_ВАК В СОСТ ОШИБКА ) В СОСТ ВыключениеПоОшибке;
 2642          			ИНАЧЕ { 
 2643          				СТАРТ ПРОЦ КонтрольОткачкиВауумнойТрубыСидеростата;
 2644          				СТОП;
 2645          			}
 2646          		} 
 2647          	}
 2648          
 2649              /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2650           СОСТ Ошибка {
 2651                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ДАВЛЕНИЕ_В_ПАТРУБКЕ_НЕ_УМЕНЬШАЕТСЯ))	В СЛЕДУЮЩЕЕ;
 2652                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2653           }
 2654           
 2655           СОСТ ВыключениеПоОшибке{
 2656               ЕСЛИ (!(ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ АКТИВНОЕ)) СТАРТ ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ;
 2657              В СЛЕДУЮЩЕЕ;
 2658           }
 2659          /*	СОСТ КонтрольВыключенияВакПодсистемы{ */
 2660          /*		ЕСЛИ ( ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ ПАССИВНОЕ){ */
 2661          /*			ЕСЛИ (ПРОЦ  ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ ОШИБКА) ОШИБКА; */
 2662          /*			ИНАЧЕ  В СОСТ СообщениеОбОтказеВакуумирования; */
 2663          /*		} */
 2664          /*	} */
 2665           СОСТ СообщениеОбОтказеВакуумирования{
 2666                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВКЛЮЧЕНИЯ_ВАКУУМНОЙ_ПОДСИСТЕМЫ))	ОШИБКА;
 2667                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи; 
 2668           } 
 2669           СОСТ НарушениеСвязи {
 2670          	   ОШИБКА;
 2671           }    
 2672          }
 2673          /*================================================================*/
 2674          /*          Процесс Выключить вакуумную подсистему вакуумный      */
 2675          /*   Этапы выключения вакуумного насоса:                          */
 2676          /*    1. Закрывается затвор вакуумный                             */
 2677          /*    2. Открывается сапун                                        */
 2678          /*    3. Ничего не делаем 20 секунд                               */
 2679          /*    4. Выключаем устройство плавного пуска                      */
 2680          /*    5. Выключаем питание вакуумного насоса                      */
 2681          /*    6. Выключаем питание насоса охлаждения                      */
 2682          /*    7. Выключаем питание вентилятора                            */
 2683          /*================================================================*/
 2684          ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ{
 2685           ИЗ ПРОЦ Инициализация 	У_ПИТ_НАС_ОХЛ;
 2686           
 2687          	СОСТ Начало{
 2688           		СТАРТ ПРОЦ ЗАКР_ЗАТВОР_ВАК;
 2689          		СТОП ПРОЦ КонтрольОткачкиВауумнойТрубыСидеростата;
 2690          		В СЛЕДУЮЩЕЕ;
 2691          	}  
 2692          	СОСТ КонтрольЗакрытияЗатвораВакуумного{
 2693          		ЕСЛИ (ПРОЦ ЗАКР_ЗАТВОР_ВАК В СОСТ ПАССИВНОЕ){ 
 2694          			ЕСЛИ (ПРОЦ ЗАКР_ЗАТВОР_ВАК В СОСТ ОШИБКА ) В СОСТ СообщениеОбОтказеВыклВакСистемы;
 2695          			ИНАЧЕ {
 2696          				СТАРТ ПРОЦ ОТКР_САПУН;
 2697          				В СЛЕДУЮЩЕЕ;
 2698          			}
 2699          		} 
 2700          	} 
 2701          	СОСТ КонтрольОткрытияСапуна{
 2702          		ЕСЛИ ( ПРОЦ ОТКР_САПУН В СОСТ ПАССИВНОЕ){ 
 2703          			ЕСЛИ (ПРОЦ ОТКР_САПУН В СОСТ ОШИБКА ) В СОСТ СообщениеОбОтказеВыклВакСистемы;
 2704          			ИНАЧЕ {
 2705          				
 2706          				В СЛЕДУЮЩЕЕ;
 2707          			}
 2708          		} 
 2709          	} 
 2710          	СОСТ ТаймаутПередВыключениемПитанияВакуумногоНасоса{  
 2711          		ТАЙМАУТ ДВАДЦАТЬ_СЕКУНД В СЛЕДУЮЩЕЕ; 
 2712          	}  
 2713          	СОСТ ВыключаемУППВакуумногоНасоса{  
 2714          		СТАРТ ПРОЦ ВЫК_УСТР_ПЛАВ_ПУСКА; В СЛЕДУЮЩЕЕ; 
 2715          	}	
 2716          	СОСТ КонтрольВыключенияПитанияУППВакуумногоНасоса{
 2717          		ЕСЛИ ( ПРОЦ ВЫК_УСТР_ПЛАВ_ПУСКА В СОСТ ПАССИВНОЕ){ 
 2718          			ЕСЛИ (ПРОЦ  ВЫК_УСТР_ПЛАВ_ПУСКА В СОСТ ОШИБКА) В СОСТ СообщениеОбОтказеВыклВакСистемы;
 2719          			ИНАЧЕ {
 2720          				СТАРТ ПРОЦ ВЫК_ПИТ_ВАК_НАСОСА;
 2721          				В СЛЕДУЮЩЕЕ;
 2722          			}
 2723          		} 
 2724          	}   
 2725          	СОСТ КонтрольВыключенияПитанияВакуумногоНасоса{
 2726          		ЕСЛИ ( ПРОЦ ВЫК_ПИТ_ВАК_НАСОСА В СОСТ ПАССИВНОЕ){ 
 2727          			ЕСЛИ (ПРОЦ  ВЫК_ПИТ_ВАК_НАСОСА В СОСТ ОШИБКА) В СОСТ СообщениеОбОтказеВыклВакСистемы;
 2728          			ИНАЧЕ {
 2729          				СТАРТ ПРОЦ ВЫК_ПИТ_НАС_ОХЛ;
 2730          				В СЛЕДУЮЩЕЕ;
 2731          			}
 2732          		} 
 2733          	}   	
 2734          	СОСТ КонтрольВыключенияНасосаОхлаждения{
 2735          		ЕСЛИ ( ПРОЦ ВЫК_ПИТ_НАС_ОХЛ В СОСТ ПАССИВНОЕ){ 
 2736          				ЕСЛИ (ПРОЦ  ВЫК_ПИТ_НАС_ОХЛ В СОСТ ОШИБКА ) В СОСТ СообщениеОбОтказеВыклВакСистемы;
 2737          				ИНАЧЕ {
 2738          					СТАРТ ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР;
 2739          					В СЛЕДУЮЩЕЕ;
 2740          				}
 2741          		}
 2742          	}  
 2743          	СОСТ КонтрольВыключенияВентилятора{
 2744          		ЕСЛИ ( ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР В СОСТ ПАССИВНОЕ){ 
 2745          				ЕСЛИ (ПРОЦ ВЫК_ПИТ_ВЕНТИЛЯТОР В СОСТ ОШИБКА ) В СОСТ СообщениеОбОтказеВыклВакСистемы;
 2746          
 2747          				ИНАЧЕ СТОП;
 2748          		}
 2749          	} 
 2750            /*= НЕНОРМАЛЬНЫЕ СИТУАЦИИ: ================*/
 2751           СОСТ СообщениеОбОтказеВыклВакСистемы{
 2752                ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВЫКЛЮЧЕНИЯ_ВАКУУМНОЙ_ПОДСИСТЕМЫ))	ОШИБКА;
 2753                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи; 
 2754           } 
 2755           СОСТ НарушениеСвязи {
 2756          	   ОШИБКА;
 2757           }  
 2758          	
 2759          } /*конец процесса ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ */
 2760          
 2761          /*====================================================================*/
 2762          /*              Процесс ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ 				      */
 2763          /* Процесс смотрит готовность вакуума, если в норме, то стопует себя. */
 2764          /* иначе запускает процесс ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ, и контролирует        */
 2765          /* глубину откачки вак-ной трубы , как только вакуумирование          */
 2766          /*  достигнет нормы ( нужный вакуум есть) процесс                     */
 2767          /*  заканчивается без ошибки. Насос вакуумный выключается             */
 2768          /*  Если вакуумирование  не пошло или                                 */
 2769          /*  откачка не на уровне, данный процесс завершается с ошибкой  и     */
 2770          /* насос вакуумный выключается.                                       */
 2771          /*====================================================================*/
 2772          ПРОЦ ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ{
 2773           ИЗ ПРОЦ Инициализация 	ФлагГотовВакуумаВТ,
 2774          						ФлагОткачкиТрубыСидеростата,
 2775          						ФП_P_ВтрубеСидер,
 2776          						ФП_T_Врубашке,
 2777          						НП_ГлубокийВакуумТрубы,
 2778          						К_ПИТ_ВЕНТИЛЯТОРА,
 2779          						К_ПИТ_НАСОС_ОХЛ;
 2780           ПЛАВ ЛП_Предыдущее ЛОКАЛ;
 2781           
 2782           СОСТ Начало{
 2783             ЕСЛИ (ФлагГотовВакуумаВТ == НОРМА) В СОСТ ПаузаНаРазвакуумированиеТрубы;
 2784             ИНАЧЕ {  
 2785          	СТАРТ ПРОЦ ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ;
 2786          	В СЛЕДУЮЩЕЕ;
 2787          	} 
 2788           }
 2789          	СОСТ КонтрольВключенияВакПодсистемы{
 2790          		ЕСЛИ ( ПРОЦ ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ ПАССИВНОЕ){ 
 2791          			ЕСЛИ (ПРОЦ ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ ОШИБКА ) {
 2792          				ОШИБКА;  /* ?  ВКЛ_ВАКУУМНУЮ_ПОДСИСТЕМУ сам выключает насос и сообщает об ошибке*/
 2793          			}
 2794          			ИНАЧЕ В СЛЕДУЮЩЕЕ;
 2795          		} 
 2796          	} 
 2797          	СОСТ ЗапоминаемДавлениеВвакуумнойТрубе{
 2798          			ЛП_Предыдущее = ФП_P_ВтрубеСидер;
 2799          			В СЛЕДУЮЩЕЕ;
 2800          	}
 2801          		/* контроль перегрева рубашки, самопроизвольного выключения вентилятора и водяного насоса*/
 2802          	СОСТ КонтрольОборудования{  
 2803          			ЕСЛИ ( (ФП_T_Врубашке <= 85) && (К_ПИТ_ВЕНТИЛЯТОРА) && (К_ПИТ_НАСОС_ОХЛ) ) В СЛЕДУЮЩЕЕ;
 2804          			ИНАЧЕ {
 2805          				В СОСТ ВыключениеВакуумнойПодсистемы;
 2806          			}
 2807          	}
 2808          	СОСТ КонтрольДавления{  
 2809          		ЕСЛИ (ФП_P_ВтрубеСидер <= НП_ГлубокийВакуумТрубы) {  /*достигли нужного давления*/
 2810          			СТАРТ ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ; 
 2811          			В СЛЕДУЮЩЕЕ;
 2812          		}
 2813          		ИНАЧЕ В СОСТ ПаузаНаОткачкуВвакуумнойТрубе;
 2814          	}
 2815          	СОСТ СообщениеОКонцеВакуумирования{
 2816          		ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ВАКУУМИРОВАНИЕ_УСПЕШНО_ЗАВЕРШЕНО)) В СЛЕДУЮЩЕЕ; 
 2817          		ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ ОШИБКА;
 2818          	}
 2819          	 СОСТ ПаузаНаРазвакуумированиеТрубы{
 2820                ТАЙМАУТ ОДНА_МИНУТА В СОСТ Начало;       /*   НП надо сделать ???????*/
 2821          	}
 2822          	СОСТ ПаузаНаОткачкуВвакуумнойТрубе{  
 2823          		ТАЙМАУТ ДВЕ_МИНУТЫ В СЛЕДУЮЩЕЕ; 
 2824          	}  
 2825          	СОСТ ПроверкаУменьшенияДавленияВпатрубке{  
 2826          		ЕСЛИ(ФП_P_ВтрубеСидер < ЛП_Предыдущее) В СОСТ ЗапоминаемДавлениеВвакуумнойТрубе;
 2827                  ИНАЧЕ В СОСТ ОткачкаОтсутствует;	
 2828          	} 
 2829          /*====== НЕНОРМАЛЬНЫЕ СИТУАЦИИ =========*/
 2830           СОСТ ОткачкаОтсутствует {
 2831                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ДАВЛЕНИЕ_В_ВАК_ТРУБЕ_НЕ_УМЕНЬШАЕТСЯ))	В СЛЕДУЮЩЕЕ;
 2832                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи;
 2833           }
 2834           СОСТ ВыключениеВакуумнойПодсистемы{
 2835               ЕСЛИ (!(ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ АКТИВНОЕ)) СТАРТ ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ;
 2836              В СЛЕДУЮЩЕЕ;
 2837           }
 2838           СОСТ СообщениеОбОтказеВакуумирования{
 2839                 ЕСЛИ (SendMsgGUICode(ПК_ГУИ_ОТКАЗ_ВАКУУМИРОВАНИЯ))	ОШИБКА;
 2840                ТАЙМАУТ ТАЙМАУТ_НА_СВЯЗЬ_С_ГУИ В СОСТ НарушениеСвязи; 
 2841           } 
 2842          	СОСТ НарушениеСвязи {
 2843          	   ОШИБКА;
 2844          	}
 2845           } /*конец процесса ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ */
 2846          /*====================================================================*/
 2847          /*              Процесс ВЫК_ВАКУУМИРОВАНИЕ_ТРУБЫ 				     */
 2848          /*                                    								*/
 2849          /*====================================================================*/
 2850           ПРОЦ ВЫК_ВАКУУМИРОВАНИЕ_ТРУБЫ{
 2851          	СОСТ Начало{
 2852          		СТОП ПРОЦ ВКЛ_ВАКУУМИРОВАНИЕ_ТРУБЫ;
 2853          /*		ЕСЛИ (ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ В СОСТ ПАССИВНОЕ) СТАРТ ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ;*/
 2854          	СТАРТ ПРОЦ ВЫК_ВАКУУМНУЮ_ПОДСИСТЕМУ; /*этот процесс может уже и отработать. флаг надо ввести*/
 2855          	СТОП;
 2856          	}
 2857           }  /*конец процесса ВЫК_ВАКУУМИРОВАНИЕ_ТРУБЫ */
 2858          }  /* \Прогр */

%RCSL-I-SUMMARY, Completed with 0 error(s).
%RCSL-I-SUMMARY, Completed with 0 warning(s).

 %RCSL-I-SUMMARY, Completed with 0 error(s).